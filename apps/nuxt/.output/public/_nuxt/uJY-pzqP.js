import{_ as O}from"./DpyZvHBp.js";import{d as $,i as L,z as R,o as s,c as n,a as v,t as k,F as j,r as E,f as p,k as i,j as D,l as _,n as z,X as V,Q as G,R as U,Z as q,$ as A,S as H,ag as J,ar as P,h as B,w as b,as as W,b as K,U as M,bb as Q,a7 as X,a8 as Z,aR as I,aN as Y,b3 as ee,b4 as te}from"./Dbiv707D.js";import{B as se}from"./BKwk18oP.js";import{B as ae}from"./CdkHU8iM.js";import{E as oe}from"./pfyoj1Bm.js";import{B as re}from"./B55v04t5.js";import{D as F}from"./fRBxe6y_.js";import{B as le}from"./BgVYQ2O1.js";import{u as ce}from"./D3vbuhP9.js";import{B as ie}from"./CjoTdGiq.js";import"./DdQRNC7l.js";import"./BLlR_Egx.js";import"./BoDBgGOH.js";import"./BgBSFNGi.js";import"./DScG_TK1.js";import"./Bqmt5lv0.js";import"./U7X5gOHL.js";import"./C3NBTwW5.js";const ne={class:"flex items-center"},ue={class:"category shrink-0"},de={class:"tags"},pe=["onClick"],ge=$({__name:"DictGroup",props:{category:null,groupByTag:null,selectId:null},emits:["selectDict","detail"],setup(g,{emit:S}){const f=g,C=S,y=D(()=>Object.keys(f.groupByTag));let u=L(y.value[0]),m=D(()=>f.groupByTag[u.value]);return R(()=>f.groupByTag,()=>{u.value=y.value[0]}),(T,h)=>(s(),n("div",null,[v("div",ne,[v("div",ue,k(g.category)+"：",1),v("div",de,[(s(!0),n(j,null,E(Object.keys(g.groupByTag),o=>(s(),n("div",{class:z(["tag",o===i(u)&&"active"]),onClick:w=>_(u)?u.value=o:u=o},k(o),11,pe))),256))])]),p(F,{onSelectDict:h[0]||(h[0]=o=>C("selectDict",o)),list:i(m),"select-id":g.selectId},null,8,["list","select-id"])]))}}),fe=Object.assign(V(ge,[["__scopeId","data-v-da2399ca"]]),{__name:"DictGroup"}),me={class:"card min-h-200 dict-list-page"},_e={class:"flex items-center relative gap-2 header-section"},ve={key:0,class:"flex flex-1 gap-4"},ye={key:1,class:"py-1 flex flex-1 justify-end"},he={class:"page-title absolute w-full center"},Be={key:0,class:"mt-4"},ke={key:1,class:"w-full"},De=$({__name:"dict-list",setup(g){const{nav:S}=G(),f=U(),C=q(),y=A(),u=H();function m(e){console.log(e.dict),T(e.dict)}async function T(e){f.editDict=M(e),S("/dict",{from:"list"})}function h(e){return e.reduce((t,r)=>(r.tags.forEach(a=>{t[a]?t[a].push(r):t[a]=[r]}),t),{})}const{data:o,isFetching:w}=ce(ee(te.WORD.ALL)).json(),N=D(()=>{let e=[];if(!o.value)return e;const t=Q(o.value,"category");for(const[r,a]of Object.entries(t))e.push([r,h(a)]);return[e[2],e[3]]=[e[3],e[2]],e});let d=L(!1),l=L("");const x=D(()=>{if(l.value){let e=l.value.toLowerCase();return o.value.filter(t=>t.id.toLowerCase().includes(e)||t.name.toLowerCase().includes(e)||t.category.toLowerCase().includes(e)||t.tags.join("").replace("所有","").toLowerCase().includes(e)||t?.url?.toLowerCase?.().includes?.(e))}return[]});return R(o,e=>{if(!e.length)return;let t=e.find(r=>r.id==="cet4");t&&J(async()=>{const r=await X("Shepherd",Z.SHEPHERD),a=new r.Tour(I);a.on("cancel",()=>{localStorage.setItem("tour-guide","1")}),a.addStep({id:"step2",text:"选一本自己准备学习的词典",attachTo:{element:"#cet4",on:"bottom"},buttons:[{text:`下一步（2/${I.total}）`,action(){a.next(),m({dict:t})}}]});const c=localStorage.getItem("tour-guide");C.first&&!c&&!Y()&&a.start()},500)}),(e,t)=>{const r=O,a=P("loading");return s(),B(se,null,{default:b(()=>[W((s(),n("div",me,[v("div",_e,[p(le,{class:"z-2",onClick:i(u).back},null,8,["onClick"]),i(d)?(s(),n("div",ve,[p(ie,{clearable:"",placeholder:"请输入词典名称/缩写/类别",modelValue:i(l),"onUpdate:modelValue":t[0]||(t[0]=c=>_(l)?l.value=c:l=c),class:"flex-1",autofocus:""},null,8,["modelValue"]),p(re,{onClick:t[1]||(t[1]=c=>(_(d)?d.value=!1:d=!1,_(l)?l.value="":l=""))},{default:b(()=>[K(k(e.$t("cancel")),1)]),_:1})])):(s(),n("div",ye,[v("span",he,k(e.$t("dict_list")),1),p(ae,{title:e.$t("search"),onClick:t[2]||(t[2]=c=>_(d)?d.value=!0:d=!0),class:"z-1",icon:"fluent:search-24-regular"},{default:b(()=>[p(r)]),_:1},8,["title"])]))]),i(l)?(s(),n("div",Be,[x.value.length?(s(),B(F,{key:0,onSelectDict:m,list:x.value,quantifier:"词","select-id":"-1"},null,8,["list"])):(s(),B(oe,{key:1,text:"没有相关词典"}))])):(s(),n("div",ke,[(s(!0),n(j,null,E(i(N),c=>(s(),B(fe,{"select-id":i(y).sdict.id,onSelectDict:m,quantifier:"词",groupByTag:c[1],category:c[0]},null,8,["select-id","groupByTag","category"]))),256))]))])),[[a,i(w)]])]),_:1})}}}),Ue=V(De,[["__scopeId","data-v-00ffeb1c"]]);export{Ue as default};
