import{_ as Q}from"./DpyZvHBp.js";import{s as Z,p as X,q as Y,v as K,x as ee,y as te,z as q,B as $,C as ae,j as O,D as p,E as se,i as I,H as k,I as ne,J as oe,k as C,K as re,L as ie,M as W,N as ce,P as le,d as ue,Q as fe,R as de,S as he,T as _e,o as B,h as L,w as z,a as V,f as R,c as F,l as j,b as ye,e as me,U as ve}from"./Dbiv707D.js";import{B as ge}from"./BKwk18oP.js";import{B as De}from"./CdkHU8iM.js";import{E as be}from"./pfyoj1Bm.js";import{B as pe}from"./B55v04t5.js";import{D as A}from"./fRBxe6y_.js";import{B as we}from"./BgVYQ2O1.js";import{B as Be}from"./CjoTdGiq.js";import"./DdQRNC7l.js";import"./BLlR_Egx.js";import"./BoDBgGOH.js";import"./BgBSFNGi.js";import"./DScG_TK1.js";import"./U7X5gOHL.js";import"./C3NBTwW5.js";const Ce=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Ee=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Pe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",E=[];class Se{_data=new S;_hash=new S([...Ce]);_nDataBytes=0;_minBufferSize=0;finalize(e){e&&this._append(e);const a=this._nDataBytes*8,t=this._data.sigBytes*8;return this._data.words[t>>>5]|=128<<24-t%32,this._data.words[(t+64>>>9<<4)+14]=Math.floor(a/4294967296),this._data.words[(t+64>>>9<<4)+15]=a,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(e,a){const t=this._hash.words;let s=t[0],i=t[1],o=t[2],r=t[3],u=t[4],y=t[5],c=t[6],f=t[7];for(let l=0;l<64;l++){if(l<16)E[l]=e[a+l]|0;else{const b=E[l-15],v=(b<<25|b>>>7)^(b<<14|b>>>18)^b>>>3,d=E[l-2],M=(d<<15|d>>>17)^(d<<13|d>>>19)^d>>>10;E[l]=v+E[l-7]+M+E[l-16]}const h=u&y^~u&c,_=s&i^s&o^i&o,m=(s<<30|s>>>2)^(s<<19|s>>>13)^(s<<10|s>>>22),w=(u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25),g=f+w+h+Ee[l]+E[l],D=m+_;f=c,c=y,y=u,u=r+g|0,r=o,o=i,i=s,s=g+D|0}t[0]=t[0]+s|0,t[1]=t[1]+i|0,t[2]=t[2]+o|0,t[3]=t[3]+r|0,t[4]=t[4]+u|0,t[5]=t[5]+y|0,t[6]=t[6]+c|0,t[7]=t[7]+f|0}_append(e){typeof e=="string"&&(e=S.fromUtf8(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes}_process(e){let a,t=this._data.sigBytes/64;e?t=Math.ceil(t):t=Math.max((t|0)-this._minBufferSize,0);const s=t*16,i=Math.min(s*4,this._data.sigBytes);if(s){for(let o=0;o<s;o+=16)this._doProcessBlock(this._data.words,o);a=this._data.words.splice(0,s),this._data.sigBytes-=i}return new S(a,i)}}class S{words;sigBytes;constructor(e,a){e=this.words=e||[],this.sigBytes=a===void 0?e.length*4:a}static fromUtf8(e){const a=unescape(encodeURIComponent(e)),t=a.length,s=[];for(let i=0;i<t;i++)s[i>>>2]|=(a.charCodeAt(i)&255)<<24-i%4*8;return new S(s,t)}toBase64(){const e=[];for(let a=0;a<this.sigBytes;a+=3){const t=this.words[a>>>2]>>>24-a%4*8&255,s=this.words[a+1>>>2]>>>24-(a+1)%4*8&255,i=this.words[a+2>>>2]>>>24-(a+2)%4*8&255,o=t<<16|s<<8|i;for(let r=0;r<4&&a*8+r*6<this.sigBytes*8;r++)e.push(Pe.charAt(o>>>6*(3-r)&63))}return e.join("")}concat(e){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let a=0;a<e.sigBytes;a++){const t=e.words[a>>>2]>>>24-a%4*8&255;this.words[this.sigBytes+a>>>2]|=t<<24-(this.sigBytes+a)%4*8}else for(let a=0;a<e.sigBytes;a+=4)this.words[this.sigBytes+a>>>2]=e.words[a>>>2];this.sigBytes+=e.sigBytes}}function Oe(n){return new Se().finalize(n).toBase64()}function P(n){return Oe(Z(n))}const Me={trailing:!0};function Re(n,e=25,a={}){if(a={...Me,...a},!Number.isFinite(e))throw new TypeError("Expected `wait` to be a finite number");let t,s,i=[],o,r;const u=(f,l)=>(o=xe(n,f,l),o.finally(()=>{if(o=null,a.trailing&&r&&!s){const h=u(f,r);return r=null,h}}),o),y=function(...f){return a.trailing&&(r=f),o||new Promise(l=>{const h=!s&&a.leading;clearTimeout(s),s=setTimeout(()=>{s=null;const _=a.leading?t:u(this,f);r=null;for(const m of i)m(_);i=[]},e),h?(t=u(this,f),l(t)):i.push(l)})},c=f=>{f&&(clearTimeout(f),s=null)};return y.isPending=()=>!!s,y.cancel=()=>{c(s),i=[],r=null},y.flush=()=>{if(c(s),!r||o)return;const f=r;return r=null,u(this,f)},y}async function xe(n,e,a){return await n.apply(e,a)}const Le=Symbol.for("nuxt:client-only");function Fe(...n){const e=typeof n[n.length-1]=="string"?n.pop():void 0;je(n[0],n[1])&&n.unshift(e);let[a,t,s={}]=n,i=!1;const o=O(()=>p(a));if(typeof o.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof t!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const r=X();s.server??=!0,s.default??=Te,s.getCachedData??=J,s.lazy??=!1,s.immediate??=!0,s.deep??=Y.deep,s.dedupe??="cancel",s._functionName,r._asyncData[o.value];function u(){const _={cause:"initial",dedupe:s.dedupe};return r._asyncData[o.value]?._init||(_.cachedData=s.getCachedData(o.value,r,{cause:"initial"}),r._asyncData[o.value]=H(r,o.value,t,s,_.cachedData)),()=>r._asyncData[o.value].execute(_)}const y=u(),c=r._asyncData[o.value];c._deps++;const f=s.server!==!1&&r.payload.serverRendered;{let _=function(v){const d=r._asyncData[v];d?._deps&&(d._deps--,d._deps===0&&d?._off())};const m=se();if(m&&f&&s.immediate&&!m.sp&&(m.sp=[]),m&&!m._nuxtOnBeforeMountCbs){m._nuxtOnBeforeMountCbs=[];const v=m._nuxtOnBeforeMountCbs;K(()=>{v.forEach(d=>{d()}),v.splice(0,v.length)}),ee(()=>v.splice(0,v.length))}const w=m&&(m._nuxtClientOnly||te(Le,!1));f&&r.isHydrating&&(c.error.value||c.data.value!==void 0)?c.status.value=c.error.value?"error":"success":m&&(!w&&r.payload.serverRendered&&r.isHydrating||s.lazy)&&s.immediate?m._nuxtOnBeforeMountCbs.push(y):s.immediate&&c.status.value!=="success"&&y();const g=ie(),D=q(o,(v,d)=>{if((v||d)&&v!==d){i=!0;const M=r._asyncData[d]?.data.value!==void 0,T=r._asyncDataPromises[d]!==void 0,U={cause:"initial",dedupe:s.dedupe};if(!r._asyncData[v]?._init){let x;d&&M?x=r._asyncData[d].data.value:(x=s.getCachedData(v,r,{cause:"initial"}),U.cachedData=x),r._asyncData[v]=H(r,v,t,s,x)}r._asyncData[v]._deps++,d&&_(d),(s.immediate||M||T)&&r._asyncData[v].execute(U),$(()=>{i=!1})}},{flush:"sync"}),b=s.watch?q(s.watch,()=>{i||(r._asyncData[o.value]?._execute.isPending()&&$(()=>{r._asyncData[o.value]?._execute.flush()}),r._asyncData[o.value]?._execute({cause:"watch",dedupe:s.dedupe}))}):()=>{};g&&ae(()=>{D(),b(),_(o.value)})}const l={data:N(()=>r._asyncData[o.value]?.data),pending:N(()=>r._asyncData[o.value]?.pending),status:N(()=>r._asyncData[o.value]?.status),error:N(()=>r._asyncData[o.value]?.error),refresh:(..._)=>r._asyncData[o.value]?._init?r._asyncData[o.value].execute(..._):u()(),execute:(..._)=>l.refresh(..._),clear:()=>{const _=r._asyncData[o.value];if(_?._abortController)try{_._abortController.abort(new DOMException("AsyncData aborted by user.","AbortError"))}finally{_._abortController=void 0}G(r,o.value)}},h=Promise.resolve(r._asyncDataPromises[o.value]).then(()=>l);return Object.assign(h,l),h}function N(n){return O({get(){return n()?.value},set(e){const a=n();a&&(a.value=e)}})}function je(n,e){return!(typeof n=="string"||typeof n=="object"&&n!==null||typeof n=="function"&&typeof e=="function")}function G(n,e){e in n.payload.data&&(n.payload.data[e]=void 0),e in n.payload._errors&&(n.payload._errors[e]=void 0),n._asyncData[e]&&(n._asyncData[e].data.value=C(n._asyncData[e]._default()),n._asyncData[e].error.value=void 0,n._asyncData[e].status.value="idle"),e in n._asyncDataPromises&&(n._asyncDataPromises[e]=void 0)}function Ne(n,e){const a={};for(const t of e)a[t]=n[t];return a}function H(n,e,a,t,s){n.payload._errors[e]??=void 0;const i=t.getCachedData!==J,o=a,r=t.deep?I:k,u=s!==void 0,y=n.hook("app:data:refresh",async f=>{(!f||f.includes(e))&&await c.execute({cause:"refresh:hook"})}),c={data:r(u?s:t.default()),pending:O(()=>c.status.value==="pending"),error:re(n.payload._errors,e),status:k("idle"),execute:(...f)=>{const[l,h=void 0]=f,_=l&&h===void 0&&typeof l=="object"?l:{};if(n._asyncDataPromises[e]&&(_.dedupe??t.dedupe)==="defer")return n._asyncDataPromises[e];{const g="cachedData"in _?_.cachedData:t.getCachedData(e,n,{cause:_.cause??"refresh:manual"});if(g!==void 0)return n.payload.data[e]=c.data.value=g,c.error.value=void 0,c.status.value="success",Promise.resolve(g)}c._abortController&&c._abortController.abort(new DOMException("AsyncData request cancelled by deduplication","AbortError")),c._abortController=new AbortController,c.status.value="pending";const m=new AbortController,w=new Promise((g,D)=>{try{const b=_.timeout??t.timeout,v=Ue([c._abortController?.signal,_?.signal],m.signal,b);if(v.aborted){const d=v.reason;D(d instanceof Error?d:new DOMException(String(d??"Aborted"),"AbortError"));return}return v.addEventListener("abort",()=>{const d=v.reason;D(d instanceof Error?d:new DOMException(String(d??"Aborted"),"AbortError"))},{once:!0,signal:m.signal}),Promise.resolve(o(n,{signal:v})).then(g,D)}catch(b){D(b)}}).then(async g=>{let D=g;t.transform&&(D=await t.transform(g)),t.pick&&(D=Ne(D,t.pick)),n.payload.data[e]=D,c.data.value=D,c.error.value=void 0,c.status.value="success"}).catch(g=>{if(n._asyncDataPromises[e]&&n._asyncDataPromises[e]!==w||c._abortController?.signal.aborted)return n._asyncDataPromises[e];if(typeof DOMException<"u"&&g instanceof DOMException&&g.name==="AbortError")return c.status.value="idle",n._asyncDataPromises[e];c.error.value=oe(g),c.data.value=C(t.default()),c.status.value="error"}).finally(()=>{m.abort(),delete n._asyncDataPromises[e]});return n._asyncDataPromises[e]=w,n._asyncDataPromises[e]},_execute:Re((...f)=>c.execute(...f),0,{leading:!0}),_default:t.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{y(),n._asyncData[e]?._init&&(n._asyncData[e]._init=!1),i||ne(()=>{n._asyncData[e]?._init||(G(n,e),c.execute=()=>Promise.resolve())})}};return c}const Te=()=>{},J=(n,e,a)=>{if(e.isHydrating)return e.payload.data[n];if(a.cause!=="refresh:manual"&&a.cause!=="refresh:hook")return e.static.data[n]};function Ue(n,e,a){const t=n.filter(o=>!!o);if(typeof a=="number"&&a>=0){const o=AbortSignal.timeout?.(a);o&&t.push(o)}if(AbortSignal.any)return AbortSignal.any(t);const s=new AbortController;for(const o of t)if(o.aborted){const r=o.reason??new DOMException("Aborted","AbortError");try{s.abort(r)}catch{s.abort()}return s.signal}const i=()=>{const r=t.find(u=>u.aborted)?.reason??new DOMException("Aborted","AbortError");try{s.abort(r)}catch{s.abort()}};for(const o of t)o.addEventListener?.("abort",i,{once:!0,signal:e});return s.signal}function ze(n,e,a){const[t={},s]=[{},e],i=O(()=>p(n)),o=O(()=>p(t.key)||"$f"+P([s,typeof i.value=="string"?i.value:"",...Ve(t)]));if(!t.baseURL&&typeof i.value=="string"&&i.value[0]==="/"&&i.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:r,lazy:u,default:y,transform:c,pick:f,watch:l,immediate:h,getCachedData:_,deep:m,dedupe:w,timeout:g,...D}=t,b=W({...ce,...D,cache:typeof t.cache=="boolean"?void 0:t.cache}),v={server:r,lazy:u,default:y,transform:c,pick:f,immediate:h,getCachedData:_,deep:m,dedupe:w,timeout:g,watch:l===!1?[]:[...l||[],b]};return Fe(l===!1?o.value:o,(M,{signal:T})=>(t.$fetch||globalThis.$fetch)(i.value,{signal:T,...b}),v)}function Ve(n){const e=[p(n.method)?.toUpperCase()||"GET",p(n.baseURL)];for(const a of[n.query||n.params]){const t=p(a);if(!t)continue;const s={};for(const[i,o]of Object.entries(t))s[p(i)]=p(o);e.push(s)}if(n.body){const a=p(n.body);if(!a)e.push(P(a));else if(a instanceof ArrayBuffer)e.push(P(Object.fromEntries([...new Uint8Array(a).entries()].map(([t,s])=>[t,s.toString()]))));else if(a instanceof FormData){const t={};for(const s of a.entries()){const[i,o]=s;t[i]=o instanceof File?o.name:o}e.push(P(t))}else if(le(a))e.push(P(W(a)));else try{e.push(P(a))}catch{console.warn("[useFetch] Failed to hash body",a)}}return e}const Ie={class:"card min-h-50"},qe={class:"flex items-center relative gap-2"},$e={key:0,class:"flex flex-1 gap-4"},ke={key:1,class:"py-1 flex flex-1 justify-end"},Ae={key:0,class:"mt-4"},He={key:1,class:"w-full mt-2"},ct=ue({__name:"test",async setup(n){let e,a;const{nav:t}=fe(),s=de(),i=he();function o(l){console.log(l.dict),r(l.dict)}async function r(l){s.editDict=ve(l),t("/book",{from:"list"})}let u=I(!1),y=I("");const{data:c}=([e,a]=_e(()=>ze("/api/articles","$cZ_mSl7HyJ")),e=await e,a(),e),f=O(()=>{if(y.value){let l=y.value.toLowerCase();return c.value.filter(h=>h.id.toLowerCase().includes(l)||h.name.toLowerCase().includes(l)||h.category.toLowerCase().includes(l)||h.tags.join("").replace("所有","").toLowerCase().includes(l)||h?.url?.toLowerCase?.().includes?.(l))}return[]});return(l,h)=>{const _=Q;return B(),L(ge,null,{default:z(()=>[V("div",Ie,[V("div",qe,[R(we,{class:"z-2",onClick:C(i).back},null,8,["onClick"]),C(u)?(B(),F("div",$e,[R(Be,{"prefix-icon":"",placeholder:"请输入书籍名称/缩写/类别",modelValue:C(y),"onUpdate:modelValue":h[0]||(h[0]=m=>j(y)?y.value=m:y=m),class:"flex-1",autofocus:"",clearable:""},null,8,["modelValue"]),R(pe,{onClick:h[1]||(h[1]=m=>(j(u)?u.value=!1:u=!1,j(y)?y.value="":y=""))},{default:z(()=>[...h[3]||(h[3]=[ye("取消",-1)])]),_:1})])):(B(),F("div",ke,[h[4]||(h[4]=V("span",{class:"page-title absolute w-full center"},"书籍列表",-1)),R(De,{onClick:h[2]||(h[2]=m=>j(u)?u.value=!0:u=!0),class:"z-1"},{default:z(()=>[R(_)]),_:1})]))]),C(y)?(B(),F("div",Ae,[f.value.length?(B(),L(A,{key:0,onSelectDict:o,list:f.value,quantifier:"篇","select-id":"-1"},null,8,["list"])):(B(),L(be,{key:1,text:"没有相关书籍"}))])):(B(),F("div",He,[C(c)?.length?(B(),L(A,{key:0,onSelectDict:o,list:C(c),quantifier:"篇","select-id":"-1"},null,8,["list"])):me("",!0)]))])]),_:1})}}});export{ct as default};
