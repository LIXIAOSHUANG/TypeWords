import{_ as kt}from"./CMZAKU7l.js";import{_ as gt,a as bt,b as wt}from"./CeY2DpVC.js";import{_ as $t}from"./ByQDqBx8.js";import{_ as Dt}from"./a6TGg0QK.js";import{B as et}from"./CgcP0R2m.js";import{E as st}from"./CGx_iWmd.js";import{A as Ct}from"./X__3coUg.js";import{d as Tt,R as St,Z as It,$ as Bt,S as Rt,ap as At,Q as Et,i as h,bh as lt,V as Lt,U as qt,x as Nt,ag as it,z as nt,ar as Vt,o as s,c as n,a as l,as as Ft,k as t,f as u,t as o,h as b,w as g,b as N,e as f,l as k,F as p,n as V,r as w,bd as Q,be as at,a5 as G,j as S,aK as Pt,bc as Ut,af as zt,b3 as Mt,b4 as jt,X as Wt}from"./CL2Zm6Gn.js";import{B as F}from"./DrXBYfFo.js";import{E as Qt}from"./BIqup3l3.js";import{A as Gt}from"./CJHy64iq.js";import{M as Ht}from"./BKClUODy.js";import{u as Kt}from"./HGrSXmWk.js";import{B}from"./oY8pmwEW.js";import{S as Ot}from"./Du4snNxr.js";import{u as Xt}from"./YA9n7JcN.js";import"./DBw7vsOg.js";import"./DUu00FKn.js";import"./CyxMrWnv.js";import"./1RI2pLfA.js";import"./BIONxxX3.js";import"./B23dpBb2.js";import"./BqBkRU00.js";import"./Dgmg0EPc.js";import"./CAPmeoOz.js";import"./CGgiZe4D.js";import"./CA9m3cH7.js";const Zt={class:"center h-screen"},Jt={class:"bg-second w-full 3xl:w-7/10 2xl:w-8/10 xl:w-full 2xl:card 2xl:h-[97vh] h-full p-3 box-border overflow-hidden mb-0"},Yt={key:0,class:"flex box-border flex-col h-full"},te={class:"dict-header flex justify-between items-center relative"},ee={class:"flex gap-space"},se={class:"dict-title text-2xl text-align-center"},le={class:"dict-actions flex"},ie={class:"flex flex-1 overflow-hidden mt-3"},ne={class:"3xl:w-80 2xl:w-60 xl:w-55 lg:w-50 overflow-auto"},ae={class:"flex-1 shrink-0 pl-4 flex flex-col overflow-hidden"},oe={class:"flex gap-4 mt-2"},re={class:"text-lg"},de={key:0,class:"text-base mt-10"},ce={class:"flex justify-between items-center relative"},ue={class:"text-3xl"},fe={key:0,class:"ml-6 text-2xl"},pe={class:"flex items-center gap-2 mr-4"},me={key:0,class:"flex gap-1 mr-4 justify-end"},_e={key:1,class:"mt-2 text-2xl"},ve={key:0,class:"text-xl color-translate-second"},xe={class:"article-row w-full mb-10"},ye={key:0,class:"trans-row text-xl color-translate-second -mt-7 mb-10"},he={key:0},ke={class:"text-right italic"},ge={key:0,class:"text-2xl"},be={key:1,class:"trans-row text-xl color-translate-second"},we={key:0,class:"translate color-translate-second"},$e={class:"break-words w-full section"},De={class:"text-xl line-height-normal space-y-5"},Ce={key:0,class:"mt-2"},Te={class:"trans-row"},Se={class:"trans-row text-right italic"},Ie={class:"font-family text-base pr-2"},Be={class:"text-2xl font-bold"},Re={class:"mt-1 mb-3"},Ae={class:"item border border-item border-solid mt-2 p-2 bg-[var(--bg-history)] rounded-md flex justify-between"},Ee={class:"color-gray"},Le={key:0,class:"border-t-1 border-t-gray-300 border-solid border-0 center gap-2 pt-4"},qe={class:"flex items-center gap-1"},Ne={key:1,class:""},Ve={class:"dict-header flex justify-between items-center relative"},Fe={class:"dict-title absolute text-2xl text-align-center w-full"},Pe={class:"center"},Ue=Tt({__name:"[id]",setup(ze){const d=St(),$=It(),P=Bt(),H=Rt(),ot=At(),{nav:rt}=Et();let v=h(!1),y=h(!1),R=h(!1),K=h(),a=h(lt({id:-1}));function dt(e){a.value=e.item}async function ct(){let e=d.editDict;if(!e.articles.length)return G.warning("没有文章可学习！");R.value=!0,await P.changeBook(e),R.value=!1,window.umami?.track("startStudyArticle",{name:e.name,custom:e.custom,complete:e.complete,s:`name:${e.name},index:${e.lastLearnIndex},title:${e.articles[e.lastLearnIndex].title}`}),rt("/practice-articles/"+e.id)}const ut=S(()=>!(y.value||v.value)),{loading:A}=Xt();Lt(()=>{ot.query?.isAdd&&(y.value=!0,d.editDict=qt()),window.addEventListener("resize",O)}),Nt(()=>{window.removeEventListener("resize",O)});function O(){c.value==="inline"&&Y()}function ft(){v.value?v.value=!1:H.back()}const{data:pt}=Kt(Mt(jt.ARTICLE.ALL)).json();function mt(){Ht.confirm("继续此操作会重置所有文章，并从官方书籍获取最新文章列表，学习记录不会被重置。确认恢复默认吗？","恢复默认",async()=>{let e=pt.value.find(i=>i.url===d.editDict.url);if(e&&e.id){e=await Pt(e,Ut.article);let i=P.article.bookList.findIndex(_=>_.id===d.editDict.id);if(i>-1){let _=P.article.bookList[i];_.custom=!1,_.id=e.id,_.articles=e.articles,_.lastLearnIndex>=_.articles.length&&(_.lastLearnIndex=_.articles.length-1),d.editDict=_,G.success("恢复成功");return}}G.error("恢复失败")})}const U=S(()=>d.editDict.statistics?.length?d.editDict.statistics.filter(e=>e.title===a.value.title):[]),X=S(()=>d.editDict.statistics?.length?Q(at(d.editDict.statistics,"spend")):0);function _t(){if(!$.articleAutoPlayNext)return;J.value=!0;let e=d.editDict.articles.findIndex(i=>i.id===a.value.id);e>-1&&(e===d.editDict.articles.length-1&&(e=-1),a.value=d.editDict.articles[e+1])}const Z=S(()=>[lt({title:"介绍",id:-1})].concat(d.editDict.articles));let m=h(!0),J=h(!1),D=h(!1),c=h("inline"),E=h();const vt=e=>{$.articleSoundVolume=e},xt=e=>{$.articleSoundSpeed=e},yt=S(()=>a.value.text?a.value.text.split(`

`).filter(e=>e.trim()).length:0),L=S(()=>c.value==="card"&&yt.value>1);function Y(){A.value||a.value.id===-1||it(()=>{const e=E.value.getBoundingClientRect();a.value.textTranslate.split(`

`).forEach((i,_)=>{i.split(`
`).forEach((z,M)=>{const I=`${_}-${M}`,j=`.word-${I}-0`,q=E.value?.querySelector(j),W=`.translate-${I}`,r=E.value?.querySelector(W);if(q&&r&&z){const x=q.getBoundingClientRect();r.style.opacity="1",r.style.top=x.top-e.top+24+"px";const C=r.firstElementChild;C&&(C.style.width=x.left-e.left+"px")}})})})}return nt([()=>c.value,()=>a.value.id,()=>m.value],()=>{c.value!=="card"&&Y()}),nt(()=>a.value.id,()=>{it(()=>{K.value?.scrollTo(0,0)})}),(e,i)=>{const _=kt,z=Dt,M=$t,I=gt,j=bt,q=wt,W=Vt("loading");return s(),n("div",Zt,[l("div",Jt,[ut.value?Ft((s(),n("div",Yt,[l("div",te,[l("div",ee,[u(et,{class:"dict-back z-2"}),l("div",se,o(t(d).editDict.name),1)]),l("div",le,[t(d).editDict.custom&&t(d).editDict.url?(s(),b(F,{key:0,type:"info",onClick:mt},{default:g(()=>[N(o(e.$t("restore_default")),1)]),_:1})):f("",!0),u(F,{loading:t(R)||t(A),type:"info",onClick:i[0]||(i[0]=r=>k(v)?v.value=!0:v=!0)},{default:g(()=>[N(o(e.$t("edit")),1)]),_:1},8,["loading"]),u(F,{type:"info",onClick:i[1]||(i[1]=r=>t(H).push("/batch-edit-article"))},{default:g(()=>[N(o(e.$t("article_management")),1)]),_:1}),u(F,{loading:t(R)||t(A),onClick:ct},{default:g(()=>[N(o(e.$t("learn")),1)]),_:1},8,["loading"])])]),l("div",ie,[l("div",ne,[t(Z).length?(s(),b(Ct,{key:0,"show-desc":!0,onClick:dt,list:t(Z),"active-id":t(a).id},null,8,["list","active-id"])):(s(),b(st,{key:1}))]),l("div",ae,[t(a).id?(s(),n(p,{key:0},[t(a).id===-1?(s(),n(p,{key:0},[l("div",oe,[t(d).editDict?.cover?(s(),b(_,{key:0,src:t(d).editDict?.cover,class:"w-30 rounded-md",alt:""},null,8,["src"])):f("",!0),l("div",re,o(t(d).editDict.description),1)]),t(X)?(s(),n("div",de,o(e.$t("total_study_time"))+"："+o(t(X)),1)):f("",!0)],64)):(s(),n(p,{key:1},[l("div",{ref_key:"articleRef",ref:K,class:"flex-1 overflow-auto pb-30"},[l("div",null,[l("div",ce,[l("span",null,[l("span",ue,o(t(a).title),1),t(m)?(s(),n("span",fe,o(t(a).titleTranslate),1)):f("",!0)]),l("div",pe,[u(B,{title:e.$t("toggle_translation"),onClick:i[2]||(i[2]=r=>k(m)?m.value=!t(m):m=!t(m))},{default:g(()=>[t(m)?(s(),b(z,{key:0})):(s(),b(M,{key:1}))]),_:1},8,["title"]),u(B,{disabled:!t(m),title:e.$t("switch_display_mode"),onClick:i[3]||(i[3]=r=>k(D)?D.value=!t(D):D=!t(D))},{default:g(()=>[u(I)]),_:1},8,["disabled","title"])])]),t(D)?(s(),n("div",me,[u(B,{title:e.$t("line_by_line"),onClick:i[4]||(i[4]=r=>k(c)?c.value="inline":c="inline")},{default:g(()=>[u(j)]),_:1},8,["title"]),u(B,{title:e.$t("single_line"),onClick:i[5]||(i[5]=r=>k(c)?c.value="line":c="line")},{default:g(()=>[u(I)]),_:1},8,["title"]),u(B,{title:e.$t("comparison"),onClick:i[6]||(i[6]=r=>k(c)?c.value="card":c="card")},{default:g(()=>[u(q)]),_:1},8,["title"])])):f("",!0),t(a)?.question?.text?(s(),n("div",_e,[l("div",null,"Question: "+o(t(a)?.question?.text),1),t(m)&&(t(c)!=="card"||t(L))?(s(),n("div",ve,o(e.$t("question"))+": "+o(t(a)?.question?.translate),1)):f("",!0)])):f("",!0)]),l("div",{class:V(["article-content mt-6",[t(m)&&t(c)!=="card"&&"tall"]]),ref_key:"articleWrapperRef",ref:E},[l("article",null,[(s(!0),n(p,null,w(t(a).text.split(`

`),(r,x)=>(s(),n(p,{key:`para-${x}`},[l("div",xe,[(s(!0),n(p,null,w(r.split(`
`),(C,T)=>(s(),n("span",{class:V(t(c)==="line"&&"block"),key:`${x}-${T}`},[(s(!0),n(p,null,w(C.split(" ").filter(Boolean),(ht,tt)=>(s(),n("span",{class:V(`inline-block word-${x}-${T}-${tt}`),key:`${x}-${T}-${tt}`},[l("span",null,o(ht),1),i[10]||(i[10]=l("span",{class:"space"},null,-1))],2))),128))],2))),128))]),t(L)&&t(m)&&t(a).textTranslate?(s(),n("div",ye,[t(a).textTranslate.split(`

`)[x]?(s(),n("div",he,o(t(a).textTranslate.split(`

`)[x]),1)):f("",!0)])):f("",!0)],64))),128)),l("div",ke,[t(a)?.quote?.text?(s(),n("div",ge,o(t(a)?.quote?.text),1)):f("",!0),t(a)?.quote?.translate&&t(m)&&(t(c)!=="card"||t(L))?(s(),n("div",be,o(t(a)?.quote?.translate),1)):f("",!0)])]),t(m)&&t(a).textTranslate?(s(),n(p,{key:0},[t(c)!=="card"?(s(),n("div",we,[(s(!0),n(p,null,w(t(a).textTranslate.split(`

`),(r,x)=>(s(),n("div",$e,[(s(!0),n(p,null,w(r.split(`
`),(C,T)=>(s(),n("div",{class:V(`row translate-${x}-${T}`),key:`${x}-${T}`},[i[11]||(i[11]=l("span",{class:"space"},null,-1)),l("span",null,o(C),1)],2))),128))]))),256))])):(s(),n(p,{key:1},[t(L)?f("",!0):(s(),n(p,{key:0},[i[12]||(i[12]=l("div",{class:"line my-10"},null,-1)),l("div",De,[t(a)?.question?.translate?(s(),n("div",Ce," 问题: "+o(t(a)?.question?.translate),1)):f("",!0),(s(!0),n(p,null,w(t(a).textTranslate.split(`

`),r=>(s(),n("div",Te,o(r),1))),256)),l("div",Se,o(t(a)?.quote?.translate),1)])],64))],64))],64)):f("",!0)],2),t(U).length?(s(),n(p,{key:0},[i[13]||(i[13]=l("div",{class:"line my-10"},null,-1)),l("div",Ie,[l("div",Be,o(e.$t("study_record")),1),l("div",Re,o(e.$t("total_study_time"))+"："+o(t(Q)(t(at)(t(U),"spend"))),1),(s(!0),n(p,null,w(t(U),r=>(s(),n("div",Ae,[l("span",Ee,o(t(zt)(r.startDate)),1),l("span",null,o(t(Q)(r.spend)),1)]))),256))])],64)):f("",!0)],512),t(a).audioSrc||t(a).audioFileId?(s(),n("div",Le,[u(Gt,{article:t(a),onUpdateSpeed:xt,onUpdateVolume:vt,autoplay:t($).articleAutoPlayNext&&t(J),onEnded:_t},null,8,["article","autoplay"]),l("div",qe,[l("span",null,o(e.$t("play_next_after_end")),1),u(Ot,{modelValue:t($).articleAutoPlayNext,"onUpdate:modelValue":i[7]||(i[7]=r=>t($).articleAutoPlayNext=r)},null,8,["modelValue"])])])):f("",!0)],64))],64)):(s(),b(st,{key:1}))])])])),[[W,t(A)]]):(s(),n("div",Ne,[l("div",Ve,[u(et,{class:"dict-back z-2",onClick:i[8]||(i[8]=r=>t(y)?e.$router.back():k(v)?v.value=!1:v=!1)}),l("div",Fe,o(t(d).editDict.id?e.$t("edit_book"):e.$t("create_book")),1)]),l("div",Pe,[u(Qt,{"is-add":t(y),"is-book":!0,onClose:ft,onSubmit:i[9]||(i[9]=r=>k(v)?v.value=k(y)?y.value=!1:y=!1:v=k(y)?y.value=!1:y=!1)},null,8,["is-add"])])]))])])}}}),_s=Wt(Ue,[["__scopeId","data-v-8478726f"]]);export{_s as default};
