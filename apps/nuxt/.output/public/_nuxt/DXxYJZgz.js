import{Y as k,o as D,c as _,a as R,$ as W,Z as A,aT as b,a4 as y,bQ as B,bR as E,R as M,ap as N,S as T,z,V as U,U as v,b3 as $,aJ as j,aK as O,bc as Q,aL as V,aM as q,b4 as G,i as I,j as J}from"./Dbiv707D.js";const K={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function Y(e,o){return D(),_("svg",K,[...o[0]||(o[0]=[R("path",{fill:"currentColor",d:"M7.194 2.101a.9.9 0 0 1 1.614 0l1.521 3.082l3.401.495a.9.9 0 0 1 .5 1.535l-2.462 2.399l.581 3.387a.9.9 0 0 1-1.306.949l-3.042-1.6l-3.042 1.6a.9.9 0 0 1-1.306-.949l.58-3.387l-2.46-2.4a.9.9 0 0 1 .499-1.534l3.4-.495z"},null,-1)])])}const P=k({name:"fluent-star16-filled",render:Y}),Z={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function F(e,o){return D(),_("svg",Z,[...o[0]||(o[0]=[R("path",{fill:"currentColor",d:"M7.194 2.101a.9.9 0 0 1 1.614 0l1.521 3.082l3.401.495a.9.9 0 0 1 .5 1.535l-2.462 2.399l.581 3.387a.9.9 0 0 1-1.306.949l-3.042-1.6l-3.042 1.6a.9.9 0 0 1-1.306-.949l.58-3.387l-2.46-2.4a.9.9 0 0 1 .499-1.534l3.4-.495zM8 2.726L6.546 5.673a.9.9 0 0 1-.677.492l-3.253.473L4.97 8.932a.9.9 0 0 1 .258.797l-.555 3.24l2.91-1.53a.9.9 0 0 1 .837 0l2.91 1.53l-.556-3.24a.9.9 0 0 1 .258-.797l2.354-2.294l-3.253-.473a.9.9 0 0 1-.677-.492z"},null,-1)])])}const X=k({name:"fluent-star16-regular",render:F});function ee(){const e=W();function o(l){return!!e.collectWord.words.find(t=>t.word.toLowerCase()===l.word.toLowerCase())}function i(l){let t=e.collectWord.words.findIndex(r=>r.word.toLowerCase()===l.word.toLowerCase());t>-1?e.collectWord.words.splice(t,1):e.collectWord.words.push(l),e.collectWord.length=e.collectWord.words.length}function a(l){return!!e.knownWords.includes(l.word.toLowerCase())}function n(l){let t=e.knownWords.findIndex(r=>r===l.word.toLowerCase());t>-1?e.known.words.splice(t,1):e.known.words.push(l),e.known.length=e.known.words.length}function d(l){let t=e.wrong.words.findIndex(r=>r.word.toLowerCase()===l.word.toLowerCase());t>-1&&e.wrong.words.splice(t,1),e.wrong.length=e.wrong.words.length}function c(l){let t=e.known.words.findIndex(r=>r.word.toLowerCase()===l.word.toLowerCase());t>-1&&e.known.words.splice(t,1),e.known.length=e.known.words.length}return{isWordCollect:o,toggleWordCollect:i,isWordSimple:a,toggleWordSimple:n,delWrongWord:d,delSimpleWord:c}}function te(){const e=W();function o(a){return!!e.collectArticle?.articles?.find(n=>n.id===a.id)}function i(a){let n=e.collectArticle.articles.findIndex(d=>d.id===a.id);n>-1?e.collectArticle.articles.splice(n,1):e.collectArticle.articles.push(a),e.collectArticle.length=e.collectArticle.articles.length}return{isArticleCollect:o,toggleArticleCollect:i}}function oe(){const e=W();let o={new:[],review:[],write:[],shuffle:[]},i=e.sdict;if(i.words.slice()?.length){const n=A();let d=[e.allIgnoreWords,e.knownWords][n.ignoreSimpleWord?0:1];const c=i.perDayStudyNumber;let l=i.lastLearnIndex,t=i.complete,r=l>=i.length-1;if(t&&r){let s=n.wordReviewRatio||1,m=[e.allIgnoreWords,e.knownWords][n.ignoreSimpleWord?0:1],u=b(y(i.words)),L=0;o.write=[];for(let g of u)if(!m.includes(g.word.toLowerCase())&&(o.write.push(g),L++,L>=c*s))break;return o}let h=l,w=i.words.slice(l);for(let s of w){if(!d.includes(s.word.toLowerCase()))if(o.new.length<c)o.new.push(s);else break;h++}if(n.wordReviewRatio>=1||t){w=i.words.slice(0,l).reverse(),t&&(w=w.concat(i.words.slice(h).reverse()));for(let s of w){if(!d.includes(s.word.toLowerCase()))if(o.review.length<c)o.review.push(s);else break;l--}}if(n.wordReviewRatio>=2){let s=i.words.slice(0,l).reverse();t&&(s=s.concat(i.words.slice(h).reverse())),s=s.filter(u=>!d.includes(u.word.toLowerCase()));const m=c*(n.wordReviewRatio-1);if(s.length<=m)o.write=s;else{let u=6;const L=B(s.slice(0,u*c),6),g=Array.from({length:u},(f,p)=>p+1).reverse(),S=g.reduce((f,p)=>f+p,0),x=g.map(f=>Math.round(f/S*m));let C=[];L.map((f,p)=>{C=C.concat(E(f,x[p]))}),o.write=C}}}return o}function re(){const e=W(),o=M();let i=I(!1),a=I(!1);const n=N(),d=T();z([()=>e.load,()=>i.value],([t,r])=>{t&&r&&c()},{immediate:!0}),U(()=>{if(n.query?.isAdd)o.editDict=v();else if(o.editDict?.id)c(o.editDict);else{if(!n.params?.id)return d.push("/articles");i.value=!0}});async function c(t){if(!t){t=v();let r=n.params.id;t=e.article.bookList.find(s=>s.id===r);let w=await(await fetch($(G.ARTICLE.ALL))).json();t||(t=w.flat().find(s=>s.id===r))}if(t&&t.id){if(!t?.articles?.length&&!t?.custom&&![j.articleCollect].includes(t.en_name||t.id)&&!t?.is_default){a.value=!0;let r=await O(t,Q.article);o.editDict=r}if(e.article.bookList.find(r=>r.id===o.editDict.id)&&V.CAN_REQUEST){let r=await q({id:o.editDict.id});r.success&&(o.editDict.statistics=r.data.statistics,r.data.articles.length&&(o.editDict.articles=r.data.articles))}}else d.push("/articles");i.value=!1,a.value=!1}return{loading:J(()=>i.value||a.value)}}export{P as _,ee as a,X as b,te as c,oe as g,re as u};
