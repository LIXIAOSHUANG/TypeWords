import { _ as __unplugin_components_9 } from './checkmark-circle16-regular-BfJF9NXt.mjs';
import { ref, defineComponent, defineAsyncComponent, watch, mergeProps, unref, withCtx, createVNode, isRef, toDisplayString, createTextVNode, openBlock, createBlock, Fragment, renderList, createCommentVNode, markRaw, createElementBlock, createElementVNode, watchEffect, useSSRContext } from 'file:///Users/lishuang/Documents/workspace/web/study/vue/TypeWords-master/node_modules/vue/index.mjs';
import { _ as __unplugin_components_7 } from './play20-regular-ozWzgLyX.mjs';
import { _ as __unplugin_components_5$1 } from './question-circle20-regular-ixBvu_Z4.mjs';
import { _ as __unplugin_components_2$1 } from './settings20-regular-fog7odRI.mjs';
import { ssrRenderAttrs, ssrInterpolate, ssrRenderComponent, ssrRenderList } from 'file:///Users/lishuang/Documents/workspace/web/study/vue/TypeWords-master/node_modules/vue/server-renderer/index.mjs';
import { B as BaseButton } from './BaseButton-DUaQjEVD.mjs';
import { T as Textarea, S as Select, O as Option } from './Textarea-Ca12-GD2.mjs';
import { b as useSettingStore, h as _nextTick, c as useBaseStore, a as useRuntimeStore, g as getDefaultDict, I as getDefaultArticle, T as Toast, d as cloneDeep, B as BaseIcon, L as last, N as _parseLRC, O as getDefaultArticleWord } from './BaseIcon-Cnj57dgy.mjs';
import { h as _export_sfc, g as useI18n } from './server.mjs';
import axios from 'file:///Users/lishuang/Documents/workspace/web/study/vue/TypeWords-master/node_modules/axios/index.js';
import md5 from 'file:///Users/lishuang/Documents/workspace/web/study/vue/TypeWords-master/node_modules/md5/md5.js';
import { g as DictId, h as Tooltip, t as TranslateEngine, b as LOCAL_FILE_KEY, P as PracticeArticleWordType } from './env-CUoXYOyW.mjs';
import { s as setInterval } from './interval-CYUoNYlE.mjs';
import { a as usePlayWordAudio } from './sound-fV5MruVn.mjs';
import { nanoid } from 'file:///Users/lishuang/Documents/workspace/web/study/vue/TypeWords-master/node_modules/nanoid/index.js';
import { E as Empty } from './Empty-DqqzidIv.mjs';
import * as Comparison from 'file:///Users/lishuang/Documents/workspace/web/study/vue/TypeWords-master/node_modules/string-comparison/dist/index.mjs';
import copy from 'file:///Users/lishuang/Documents/workspace/web/study/vue/TypeWords-master/node_modules/copy-to-clipboard/index.js';
import { I as InputNumber } from './InputNumber-CwEqYfu9.mjs';
import { update } from 'file:///Users/lishuang/Documents/workspace/web/study/vue/TypeWords-master/node_modules/idb-keyval/dist/index.js';
import { A as ArticleAudio } from './ArticleAudio-HKnHxiX1.mjs';
import { B as BaseInput } from './BaseInput-mlIHP8lZ.mjs';

var __defProp = Object.defineProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __publicField = (obj, key, value) => __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
const _hoisted_1$5 = {
  viewBox: "0 0 20 20",
  width: "1.2em",
  height: "1.2em"
};
function render$5(_ctx, _cache) {
  return openBlock(), createElementBlock("svg", _hoisted_1$5, [..._cache[0] || (_cache[0] = [
    createElementVNode("path", {
      fill: "currentColor",
      d: "M9.723 2.084a.5.5 0 0 1 .554 0a15.05 15.05 0 0 0 6.294 2.421A.5.5 0 0 1 17 5v4.5c0 3.891-2.307 6.73-6.82 8.467a.5.5 0 0 1-.36 0C5.308 16.23 3 13.39 3 9.5V5a.5.5 0 0 1 .43-.495a15.05 15.05 0 0 0 6.293-2.421m-.124 1.262A16 16 0 0 1 4 5.428V9.5c0 3.392 1.968 5.863 6 7.463c4.032-1.6 6-4.071 6-7.463V5.428a16 16 0 0 1-5.6-2.082l-.4-.249zM10.75 13.75a.75.75 0 1 1-1.5 0a.75.75 0 0 1 1.5 0m-2-5.5a1.25 1.25 0 1 1 2.5 0c0 .465-.27.762-.728 1.22l-.035.035c-.415.413-.987.983-.987 1.895v.1a.5.5 0 0 0 1 0v-.1c0-.467.27-.765.728-1.222l.037-.037c.414-.412.985-.981.985-1.891a2.25 2.25 0 0 0-4.5 0a.5.5 0 0 0 1 0"
    }, null, -1)
  ])]);
}
const __unplugin_components_8 = markRaw({ name: "fluent-shield-question20-regular", render: render$5 });
const _hoisted_1$4 = {
  viewBox: "0 0 20 20",
  width: "1.2em",
  height: "1.2em"
};
function render$4(_ctx, _cache) {
  return openBlock(), createElementBlock("svg", _hoisted_1$4, [..._cache[0] || (_cache[0] = [
    createElementVNode("path", {
      fill: "currentColor",
      d: "M6 3a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3V6a3 3 0 0 0-3-3zM4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm6.5.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 1 0 1 0v-3h3a.5.5 0 1 0 0-1h-3z"
    }, null, -1)
  ])]);
}
const __unplugin_components_6 = markRaw({ name: "fluent-add-square20-regular", render: render$4 });
const _hoisted_1$3 = {
  viewBox: "0 0 20 20",
  width: "1.2em",
  height: "1.2em"
};
function render$3(_ctx, _cache) {
  return openBlock(), createElementBlock("svg", _hoisted_1$3, [..._cache[0] || (_cache[0] = [
    createElementVNode("path", {
      fill: "currentColor",
      d: "M11.997 3.002c0-.873-1.04-1.327-1.68-.733l-3.87 3.594a.5.5 0 0 1-.34.133H3.5a1.5 1.5 0 0 0-1.5 1.5v5.001a1.5 1.5 0 0 0 1.5 1.5h2.606a.5.5 0 0 1 .34.134l2.834 2.631l.153-.609q.06-.24.156-.469l-2.463-2.286a1.5 1.5 0 0 0-1.02-.4H3.5a.5.5 0 0 1-.5-.5V7.496a.5.5 0 0 1 .5-.5h2.606a1.5 1.5 0 0 0 1.02-.401l3.872-3.594v10.941l1-1zm3.965 1.66a7.97 7.97 0 0 1 1.988 4.454a2.9 2.9 0 0 0-1.022-.112a6.97 6.97 0 0 0-1.71-3.674a.5.5 0 0 1 .744-.667m-1.2 2.585c.416.72.65 1.495.718 2.272q-.2.14-.379.319l-.626.626a4.5 4.5 0 0 0-.578-2.717a.5.5 0 0 1 .865-.5m-3.782 8.128l4.828-4.83a1.87 1.87 0 1 1 2.644 2.645l-4.828 4.83a2.2 2.2 0 0 1-1.02.578l-1.498.375a.89.89 0 0 1-1.078-1.08l.374-1.497a2.2 2.2 0 0 1 .578-1.021"
    }, null, -1)
  ])]);
}
const __unplugin_components_5 = markRaw({ name: "fluent-speaker-edit20-regular", render: render$3 });
const _hoisted_1$2 = {
  viewBox: "0 0 20 20",
  width: "1.2em",
  height: "1.2em"
};
function render$2(_ctx, _cache) {
  return openBlock(), createElementBlock("svg", _hoisted_1$2, [..._cache[0] || (_cache[0] = [
    createElementVNode("path", {
      fill: "currentColor",
      d: "M2 3.5a.5.5 0 0 1 1 0v1a.5.5 0 0 1-1 0zm0 3a.5.5 0 0 1 1 0v2a.5.5 0 0 1-1 0zm0 4a.5.5 0 0 1 1 0v2a.5.5 0 0 1-1 0zm0 4a.5.5 0 0 1 1 0v1a.5.5 0 0 1-1 0zm2.146-4.646a.5.5 0 0 1 0-.708l4.5-4.5a.5.5 0 1 1 .708.708L5.707 9H15.5a.5.5 0 0 1 0 1H5.707l3.647 3.646a.5.5 0 0 1-.708.708zM17 3.5a.5.5 0 0 1 1 0v12a.5.5 0 0 1-1 0z"
    }, null, -1)
  ])]);
}
const __unplugin_components_4 = markRaw({ name: "fluent-padding-left20-regular", render: render$2 });
const _hoisted_1$1 = {
  viewBox: "0 0 20 20",
  width: "1.2em",
  height: "1.2em"
};
function render$1(_ctx, _cache) {
  return openBlock(), createElementBlock("svg", _hoisted_1$1, [..._cache[0] || (_cache[0] = [
    createElementVNode("path", {
      fill: "currentColor",
      d: "M10 13a3 3 0 1 0 0-6a3 3 0 0 0 0 6m.5-10.5a.5.5 0 0 0-1 0v1.52A6 6 0 0 0 4.02 9.5H2.5a.5.5 0 0 0 0 1h1.52a6 6 0 0 0 5.48 5.48v1.52a.5.5 0 0 0 1 0v-1.52a6 6 0 0 0 5.48-5.48h1.52a.5.5 0 0 0 0-1h-1.52a6 6 0 0 0-5.48-5.48zM10 15a5 5 0 1 1 0-10a5 5 0 0 1 0 10"
    }, null, -1)
  ])]);
}
const __unplugin_components_3 = markRaw({ name: "fluent-my-location20-regular", render: render$1 });
const _hoisted_1 = {
  viewBox: "0 0 48 48",
  width: "1.2em",
  height: "1.2em"
};
function render(_ctx, _cache) {
  return openBlock(), createElementBlock("svg", _hoisted_1, [..._cache[0] || (_cache[0] = [
    createElementVNode("g", {
      fill: "none",
      stroke: "currentColor",
      "stroke-linejoin": "round",
      "stroke-width": "4"
    }, [
      createElementVNode("path", {
        "stroke-linecap": "round",
        d: "M24 44C12.954 44 4 35.046 4 24S12.954 4 24 4s20 8.954 20 20"
      }),
      createElementVNode("path", { d: "M20 24v-6.928l6 3.464L32 24l-6 3.464l-6 3.464z" }),
      createElementVNode("path", {
        "stroke-linecap": "round",
        d: "M37.05 32v10M42 36.95H32"
      })
    ], -1)
  ])]);
}
const __unplugin_components_2 = markRaw({ name: "icon-park-outline-add-music", render });
const _sfc_main$1 = /* @__PURE__ */ defineComponent({
  __name: "EditAbleText",
  __ssrInlineRender: true,
  props: {
    value: { default: "" },
    disabled: { type: Boolean, default: false }
  },
  emits: [
    "save"
  ],
  setup(__props, { emit: __emit }) {
    const props = __props;
    const emit = __emit;
    let editVal = ref("");
    let edit = ref(false);
    watchEffect(() => {
      editVal.value = props.value;
    });
    function save() {
      emit("save", editVal.value);
      edit.value = false;
    }
    const { t: $t } = useI18n();
    function toggle() {
      if (props.disabled) return Toast.info($t("wait_translation"));
      edit.value = !edit.value;
      editVal.value = props.value;
    }
    return (_ctx, _push, _parent, _attrs) => {
      if (unref(edit)) {
        _push(`<div${ssrRenderAttrs(mergeProps({ class: "edit-text" }, _attrs))} data-v-ec729dec>`);
        _push(ssrRenderComponent(Textarea, {
          modelValue: unref(editVal),
          "onUpdate:modelValue": ($event) => isRef(editVal) ? editVal.value = $event : editVal = $event,
          ref: "inputRef",
          textarea: "",
          autosize: "",
          autofocus: "",
          type: "textarea",
          "input-style": `color: var(--color-font-1);font-size: 1rem;`
        }, null, _parent));
        _push(`<div class="flex justify-end mt-2" data-v-ec729dec>`);
        _push(ssrRenderComponent(BaseButton, { onClick: toggle }, {
          default: withCtx((_, _push2, _parent2, _scopeId) => {
            if (_push2) {
              _push2(`${ssrInterpolate(unref($t)("cancel"))}`);
            } else {
              return [
                createTextVNode(toDisplayString(unref($t)("cancel")), 1)
              ];
            }
          }),
          _: 1
        }, _parent));
        _push(ssrRenderComponent(BaseButton, { onClick: save }, {
          default: withCtx((_, _push2, _parent2, _scopeId) => {
            if (_push2) {
              _push2(`${ssrInterpolate(unref($t)("apply"))}`);
            } else {
              return [
                createTextVNode(toDisplayString(unref($t)("apply")), 1)
              ];
            }
          }),
          _: 1
        }, _parent));
        _push(`</div></div>`);
      } else {
        _push(`<div${ssrRenderAttrs(mergeProps({ class: "text" }, _attrs))} data-v-ec729dec>${ssrInterpolate(__props.value)}</div>`);
      }
    };
  }
});
const _sfc_setup$1 = _sfc_main$1.setup;
_sfc_main$1.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("components/EditAbleText.vue");
  return _sfc_setup$1 ? _sfc_setup$1(props, ctx) : void 0;
};
const EditAbleText = /* @__PURE__ */ Object.assign(_export_sfc(_sfc_main$1, [["__scopeId", "data-v-ec729dec"]]), { __name: "EditAbleText" });
class TranslateError extends Error {
  constructor(message) {
    super(message);
  }
}
class Translator {
  /**
   * 可选的axios实例
   */
  constructor(init = {}) {
    __publicField(this, "axios");
    __publicField(this, "env");
    /**
     * 自定义选项
     */
    __publicField(this, "config");
    this.env = init.env || "node";
    this.axios = init.axios || axios;
    this.config = init.config || {};
  }
  /**
   * 下游应用调用的接口
   */
  async translate(text, from, to, config = {}) {
    const queryResult = await this.query(text, from, to, {
      ...this.config,
      ...config
    });
    return {
      ...queryResult,
      engine: this.name
    };
  }
  request(url, config) {
    return this.axios(url, config);
  }
  /**
   * 如果翻译源提供了单独的检测语言的功能，请实现此接口
   */
  async detect(text) {
    return;
  }
  /**
   * 文本转换为语音
   * @returns {Promise<string|null>} 语言文件地址
   */
  textToSpeech(text, lang, meta) {
    return Promise.resolve(null);
  }
}
const qs = {
  stringify: (params) => {
    return Object.entries(params).map(([key, value]) => `${encodeURIComponent(key)}=${encodeURIComponent(value)}`).join("&");
  }
};
const langMap = [
  ["auto", "auto"],
  ["zh-CN", "zh"],
  ["en", "en"],
  ["yue", "yue"],
  ["wyw", "wyw"],
  ["ja", "jp"],
  ["ko", "kor"],
  ["fr", "fra"],
  ["es", "spa"],
  ["th", "th"],
  ["ar", "ara"],
  ["ru", "ru"],
  ["pt", "pt"],
  ["de", "de"],
  ["it", "it"],
  ["el", "el"],
  ["nl", "nl"],
  ["pl", "pl"],
  ["bg", "bul"],
  ["et", "est"],
  ["da", "dan"],
  ["fi", "fin"],
  ["cs", "cs"],
  ["ro", "rom"],
  ["sl", "slo"],
  ["sv", "swe"],
  ["hu", "hu"],
  ["zh-TW", "cht"],
  ["vi", "vie"]
];
const _Baidu = class _Baidu extends Translator {
  constructor() {
    super(...arguments);
    __publicField(this, "name", "baidu");
    __publicField(this, "endpoint", "/baidu");
  }
  async query(text, from, to, config) {
    const salt = Date.now();
    const { endpoint } = this;
    const { appid, key } = config;
    const res = await this.request(
      endpoint,
      {
        params: {
          from: _Baidu.langMap.get(from),
          to: _Baidu.langMap.get(to),
          q: text,
          salt,
          appid,
          sign: md5(appid + text + salt + key)
        }
      }
    ).catch(() => {
      throw new TranslateError("NETWORK_ERROR");
    });
    const { data } = res;
    if (data.error_code) {
      console.error(
        new Error("[Baidu service]" + data.error_msg)
      );
      throw new TranslateError("API_SERVER_ERROR");
    }
    const {
      trans_result: transResult,
      from: langDetected
    } = data;
    const transParagraphs = transResult.map(({ dst }) => dst);
    const detectedFrom = _Baidu.langMapReverse.get(langDetected);
    return {
      text,
      from: detectedFrom,
      to,
      origin: {
        paragraphs: transResult.map(({ src }) => src),
        tts: await this.textToSpeech(text, detectedFrom)
      },
      trans: {
        paragraphs: transParagraphs,
        tts: await this.textToSpeech(transParagraphs.join(" "), to)
      }
    };
  }
  getSupportLanguages() {
    return [..._Baidu.langMap.keys()];
  }
  async textToSpeech(text, lang) {
    return `https://fanyi.baidu.com/gettts?${qs.stringify({
      lan: _Baidu.langMap.get(lang !== "auto" ? lang : "zh-CN") || "zh",
      text,
      spd: 5
    })}`;
  }
};
/** Translator lang to custom lang */
__publicField(_Baidu, "langMap", new Map(langMap));
/** Custom lang to translator lang */
__publicField(_Baidu, "langMapReverse", new Map(
  langMap.map(([translatorLang, lang]) => [lang, translatorLang])
));
let Baidu = _Baidu;
function getSentenceAllTranslateText(article) {
  return article.sections.map((v) => v.map((s) => s.translate.trim()).filter((v2) => v2).join(" \n")).filter((v) => v).join(" \n\n");
}
function getSentenceAllText(article) {
  return article.sections.map((v) => v.map((s) => s.text).filter((v2) => v2).join("\n")).filter((v) => v).join("\n\n");
}
async function getNetworkTranslate(article, translateEngine, allShow = false, progressCb) {
  let translator;
  if (translateEngine === TranslateEngine.Baidu) {
    translator = new Baidu({
      config: {
        appid: "20230910001811857",
        key: "Xxe_yftQR3K3Ue43NQMC"
      }
    });
  }
  if (translator) {
    if (!article.titleTranslate) {
      translator.translate(article.title, "en", "zh-CN").then((r) => {
        article.titleTranslate = r.trans.paragraphs[0];
      });
    }
    let promiseList = [];
    let retryCount = 0;
    let retryCountMap = /* @__PURE__ */ new Map();
    const translate = async (sentence) => {
      try {
        let r = await translator.translate(sentence.text, "en", "zh-CN");
        console.log(r);
        if (r) {
          const cb = () => {
            sentence.translate = r.trans.paragraphs[0];
            if (!allShow) {
              article.textTranslate += sentence.translate + "\n";
            }
          };
          return Promise.resolve(cb);
        } else {
          return Promise.reject(() => translate(sentence));
        }
      } catch (e) {
        return Promise.reject(() => translate(sentence));
      }
    };
    let total = 0;
    let index = 0;
    article.sections.map((v) => total += v.length);
    for (let i = 0; i < article.sections.length; i++) {
      let v = article.sections[i];
      for (let j = 0; j < v.length; j++) {
        let sentence = v[j];
        let promise = translate(sentence);
        if (allShow) {
          promiseList.push(promise);
        } else {
          retryCountMap.set(sentence.text, 0);
          let errResult;
          let cb = await promise.catch((err) => {
            errResult = err;
          });
          while (errResult) {
            let count = retryCountMap.get(sentence.text);
            if (count > 2) break;
            cb = await errResult().catch((err) => {
              errResult = err;
            });
            retryCountMap.set(sentence.text, count + 1);
          }
          if (cb) cb();
          index++;
          if (progressCb) {
            progressCb(Math.floor(index / total * 100));
          }
        }
      }
    }
    if (promiseList.length) {
      let timer = -1;
      if (progressCb) {
        timer = setInterval();
      }
      return new Promise(async (resolve) => {
        let cbs = [];
        do {
          if (retryCount > 2) {
            return resolve(true);
          }
          let results = await Promise.allSettled(promiseList);
          promiseList = [];
          results.map((results2) => {
            if (results2.status === "fulfilled") {
              cbs.push(results2.value);
            } else {
              promiseList.push(results2.reason());
            }
          });
          retryCount++;
        } while (promiseList.length);
        cbs.map((v) => v());
        article.textTranslate = getSentenceAllTranslateText(article);
        if (progressCb) {
          clearInterval(timer);
          progressCb(100);
        }
        resolve(true);
      });
    } else {
      article.textTranslate = getSentenceAllTranslateText(article);
    }
  }
}
function parseSentence(sentence) {
  sentence = sentence.replace(/[\u2018\u2019\u201A\u201B]/g, "'").replace(/[\u201C\u201D\u201E\u201F]/g, '"');
  const len = sentence.length;
  const tokens = [];
  let i = 0;
  while (i < len) {
    const ch = sentence[i];
    if (/\s/.test(ch)) {
      i++;
      continue;
    }
    const rest = sentence.slice(i);
    let m = rest.match(/^[\$¥€£]\d{1,3}(?:,\d{3})*(?:\.\d+)?%?/);
    if (m) {
      tokens.push({ word: m[0], start: i, end: i + m[0].length, type: PracticeArticleWordType.Number });
      i += m[0].length;
      continue;
    }
    m = rest.match(/^\d{1,3}(?:,\d{3})*(?:\.\d+)?%?/);
    if (m) {
      tokens.push({ word: m[0], start: i, end: i + m[0].length, type: PracticeArticleWordType.Number });
      i += m[0].length;
      continue;
    }
    m = rest.match(/^[A-Za-z]+(?:\.[A-Za-z]+)+\.?/);
    if (m) {
      tokens.push({ word: m[0], start: i, end: i + m[0].length, type: PracticeArticleWordType.Word });
      i += m[0].length;
      continue;
    }
    m = rest.match(/^[A-Za-z0-9]+(?:[\'\-][A-Za-z0-9]+)*/);
    if (m) {
      tokens.push({ word: m[0], start: i, end: i + m[0].length, type: PracticeArticleWordType.Word });
      i += m[0].length;
      continue;
    }
    if (/[^\w\s]/.test(ch)) {
      tokens.push({ word: ch, start: i, end: i + 1, type: PracticeArticleWordType.Symbol });
      i += 1;
      continue;
    }
    tokens.push({ word: ch, start: i, end: i + 1, type: PracticeArticleWordType.Symbol });
    i += 1;
  }
  const result = tokens.map((t, idx) => {
    const next = tokens[idx + 1];
    const between = next ? sentence.slice(t.end, next.start) : sentence.slice(t.end);
    const nextSpace = /\s/.test(between);
    return getDefaultArticleWord({ word: t.word, nextSpace, type: t.type });
  });
  return result;
}
function genArticleSectionData(article) {
  var _a, _b;
  let text = article.text.trim();
  let sections = [];
  text.split("\n\n").filter(Boolean).map((sectionText, i) => {
    let section = [];
    sections.push(section);
    sectionText.trim().split("\n").filter(Boolean).map((item, i2, arr) => {
      item = item.trim();
      if (i2 < arr.length - 1) item += " ";
      let sentence = cloneDeep({
        text: item,
        translate: "",
        words: parseSentence(item),
        audioPosition: [0, 0]
      });
      section.push(sentence);
    });
  });
  sections = sections.filter((v) => v.length);
  article.sections = sections;
  let failCount = 0;
  let translateList = ((_a = article.textTranslate) == null ? void 0 : _a.split("\n\n")) || [];
  for (let i = 0; i < article.sections.length; i++) {
    let v = article.sections[i];
    let sList = [];
    try {
      let s = translateList[i];
      sList = s.split("\n");
    } catch (e) {
    }
    for (let j = 0; j < v.length; j++) {
      let sentence = v[j];
      try {
        let trans = sList[j];
        if (trans.trim()) {
          sentence.translate = trans;
        } else {
          failCount++;
        }
      } catch (e) {
        failCount++;
      }
    }
  }
  text = getSentenceAllText(article);
  let translate = getSentenceAllTranslateText(article);
  article.text = text;
  article.textTranslate = translate;
  let count = 0;
  if ((_b = article == null ? void 0 : article.lrcPosition) == null ? void 0 : _b.length) {
    article.sections.map((v, i) => {
      v.map((w, j) => {
        w.audioPosition = article.lrcPosition[count];
        count++;
      });
    });
  }
  return failCount;
}
function splitEnArticle2(text) {
  text = text.trim();
  if (!text) return "";
  const abbreviations = ["Mr", "Mrs", "Ms", "Dr", "Prof", "Sr", "Jr", "St", "Co", "Ltd", "Inc", "e.g", "i.e", "U.S.A", "U.S", "U.K", "etc"];
  function isSentenceEnd(text2, idx) {
    const before = text2.slice(0, idx + 1);
    const after = text2.slice(idx + 1);
    const abbrevPattern = new RegExp("\\b(" + abbreviations.join("|") + ")\\.$", "i");
    if (abbrevPattern.test(before)) return false;
    if (/\d+\.$/.test(before)) return false;
    if (/\d+\.\d/.test(text2.slice(idx - 1, idx + 2))) return false;
    if (/%/.test(after)) return false;
    if (/[\$¥€]\d/.test(before + after)) return false;
    return true;
  }
  function normalizeQuotes(text2) {
    const isWord = (ch) => /\w/.test(ch);
    let res = [];
    let singleOpen = false;
    let doubleOpen = false;
    for (let i = 0; i < text2.length; i++) {
      const ch = text2[i];
      if (ch === "'") {
        const prev = i > 0 ? text2[i - 1] : "";
        const nxt = i + 1 < text2.length ? text2[i + 1] : "";
        if (isWord(prev) && isWord(nxt)) {
          res.push("'");
          continue;
        }
        if (singleOpen) {
          if (res.length && res[res.length - 1] === " ") res.pop();
          res.push("'");
          singleOpen = false;
        } else {
          res.push("'");
          singleOpen = true;
        }
      } else if (ch === '"') {
        if (doubleOpen) {
          if (res.length && res[res.length - 1] === " ") res.pop();
          res.push('"');
          doubleOpen = false;
        } else {
          res.push('"');
          doubleOpen = true;
        }
      } else {
        res.push(ch);
      }
    }
    return res.join("");
  }
  let rawParagraphs = text.replaceAll("\n\n", "`^`").replaceAll("\n", "").split("`^`");
  const formattedParagraphs = rawParagraphs.map((p) => {
    p = p.trim();
    if (!p) return "";
    p = p.replace(/\n/g, " ");
    p = normalizeQuotes(p);
    const tentative = p.match(/[^.!?。！？]+[.!?。！？'"”’)]*/g) || [];
    const sentences = [];
    tentative.forEach((segment) => {
      segment = segment.trim();
      if (!segment) return;
      const lastCharIdx = segment.length - 1;
      if (/[.!?。！？]/.test(segment[lastCharIdx])) {
        const globalIdx = p.indexOf(segment);
        if (!isSentenceEnd(p, globalIdx + segment.length - 1)) {
          if (sentences.length > 0) {
            sentences[sentences.length - 1] += " " + segment;
          } else {
            sentences.push(segment);
          }
          return;
        }
      }
      sentences.push(segment);
    });
    const finalSentences = [];
    let i = 0;
    while (i < sentences.length) {
      let cur = sentences[i];
      if (i + 1 < sentences.length) {
        const nxt = sentences[i + 1];
        if (/['"”’)\]]$/.test(cur) && /^[a-z]|^(I|You|She|He|They|We)\b/i.test(nxt)) {
          finalSentences.push(cur + " " + nxt);
          i += 2;
          continue;
        }
      }
      finalSentences.push(cur);
      i += 1;
    }
    return finalSentences.join("\n");
  });
  return formattedParagraphs.filter((p) => p).join("\n\n");
}
function splitCNArticle2(text) {
  const segmenterJa = new Intl.Segmenter("zh-CN", { granularity: "sentence" });
  let sectionTextList = text.replaceAll("\n\n", "`^`").replaceAll("\n", "").split("`^`");
  let s = sectionTextList.filter((v) => v).map((rowSection, i) => {
    const segments = segmenterJa.segment(rowSection);
    let ss = "";
    Array.from(segments).map((sentenceRow) => {
      let row = sentenceRow.segment;
      if (row) {
        if (row[row.length - 1] === "\u201C") {
          row = row.substring(0, row.length - 1);
          ss += row + "\n\u201C";
        } else {
          ss += row + "\n";
        }
      }
    });
    return ss;
  }).join("\n").trim();
  return s;
}
function usePlaySentenceAudio() {
  const playWordAudio = usePlayWordAudio();
  useSettingStore();
  let timer = ref(0);
  function playSentenceAudio(sentence, ref2) {
    var _a, _b;
    if (((_a = sentence.audioPosition) == null ? void 0 : _a.length) && ref2 && ref2.src) {
      clearTimeout(timer.value);
      if (ref2.played) {
        ref2.pause();
      }
      let start = sentence.audioPosition[0];
      ref2.currentTime = start;
      ref2.play();
      let end = (_b = sentence.audioPosition) == null ? void 0 : _b[1];
      if (end && end !== -1) {
        timer.value = setTimeout(() => {
          console.log("\u505C");
          ref2.pause();
        }, (end - start) / ref2.playbackRate * 1e3);
      }
    } else {
      playWordAudio(sentence.text);
    }
  }
  return {
    playSentenceAudio
  };
}
function syncBookInMyStudyList(study = false) {
  _nextTick(() => {
    const base = useBaseStore();
    const runtimeStore = useRuntimeStore();
    let temp = runtimeStore.editDict;
    let rIndex = base.article.bookList.findIndex((v) => v.id === temp.id);
    if (!temp.custom && temp.id !== DictId.articleCollect) {
      temp.custom = true;
      if (!temp.id.includes("_custom")) {
        temp.id += "_custom_" + nanoid(6);
      }
    }
    temp.length = temp.articles.length;
    if (rIndex > -1) {
      base.article.bookList[rIndex] = getDefaultDict(temp);
      if (study) base.article.studyIndex = rIndex;
    } else {
      base.article.bookList.push(getDefaultDict(temp));
      if (study) base.article.studyIndex = base.article.bookList.length - 1;
    }
  }, 100);
}
const _sfc_main = /* @__PURE__ */ defineComponent({
  __name: "EditArticle",
  __ssrInlineRender: true,
  props: {
    article: { default: () => getDefaultArticle() },
    type: { default: "single" }
  },
  emits: ["save", "saveAndNext"],
  setup(__props, { expose: __expose, emit: __emit }) {
    const Dialog = defineAsyncComponent(() => import('./Dialog-BoKDmA_Y.mjs'));
    const { t: $t } = useI18n();
    const props = __props;
    const emit = __emit;
    let networkTranslateEngine = ref("baidu");
    let progress = ref(0);
    let failCount = ref(0);
    let resultRef = ref();
    const TranslateEngineOptions = [
      // {value: 'youdao', label: '有道'},
      { value: "baidu", label: "\u767E\u5EA6" }
    ];
    let editArticle = ref(getDefaultArticle());
    watch(
      () => props.article,
      (val) => {
        editArticle.value = getDefaultArticle(val);
        progress.value = 0;
        failCount.value = 0;
        apply(false);
        _nextTick(() => {
          var _a;
          (_a = resultRef.value) == null ? void 0 : _a.scrollTo(0, 0);
        });
      },
      { immediate: true }
    );
    watch(
      () => editArticle.value.text,
      (s) => {
        if (!s.trim()) {
          editArticle.value.sections = [];
        }
      }
    );
    function apply(isHandle = true) {
      let text = editArticle.value.text.trim();
      if (!text && isHandle) {
        editArticle.value.sections = [];
        Toast.error($t("please_fill_original"));
        return;
      }
      failCount.value = genArticleSectionData(editArticle.value);
    }
    function splitText() {
      editArticle.value.text = splitEnArticle2(editArticle.value.text);
    }
    function splitTranslateText() {
      editArticle.value.textTranslate = splitCNArticle2(editArticle.value.textTranslate.trim());
    }
    async function startNetworkTranslate() {
      if (!editArticle.value.title.trim()) {
        return Toast.error($t("please_fill_title"));
      }
      if (!editArticle.value.text.trim()) {
        return Toast.error($t("please_fill_content"));
      }
      editArticle.value.titleTranslate = "";
      editArticle.value.textTranslate = "";
      apply();
      setTimeout(async () => {
        await getNetworkTranslate(editArticle.value, TranslateEngine.Baidu, false, (v) => {
          progress.value = v;
        });
        failCount.value = 0;
      });
    }
    function saveSentenceTranslate(sentence, val) {
      sentence.translate = val;
      editArticle.value.textTranslate = getSentenceAllTranslateText(editArticle.value);
      apply();
    }
    function saveSentenceText(sentence, val) {
      sentence.text = val;
      editArticle.value.text = getSentenceAllText(editArticle.value);
      apply();
    }
    function save(option) {
      return new Promise((resolve) => {
        editArticle.value.title = editArticle.value.title.trim();
        editArticle.value.titleTranslate = editArticle.value.titleTranslate.trim();
        editArticle.value.text = editArticle.value.text.trim();
        editArticle.value.textTranslate = editArticle.value.textTranslate.trim();
        if (!editArticle.value.title) {
          Toast.error($t("please_fill_title"));
          return resolve(false);
        }
        if (!editArticle.value.text) {
          Toast.error($t("please_fill_content"));
          return resolve(false);
        }
        editArticle.value.lrcPosition = editArticle.value.sections.map((v) => {
          return v.map((w, j) => {
            var _a;
            return (_a = w.audioPosition) != null ? _a : [];
          });
        }).flat();
        console.log(editArticle.value);
        let d = cloneDeep(editArticle.value);
        if (!d.id) d.id = nanoid(6);
        delete d.sections;
        copy(console.json(d, 2));
        emit(option, editArticle.value);
        resolve(true);
      });
    }
    __expose({ save, getEditArticle: () => cloneDeep(editArticle.value) });
    async function handleAudioChange(e) {
      var _a, _b;
      let uploadFile = (_b = (_a = e.target) == null ? void 0 : _a.files) == null ? void 0 : _b[0];
      if (!uploadFile) return;
      let data = {
        id: nanoid(),
        file: uploadFile
      };
      await update(LOCAL_FILE_KEY, (val) => {
        if (val) val.push(data);
        else val = [data];
        return val;
      });
      editArticle.value.audioFileId = data.id;
      editArticle.value.audioSrc = "";
      e.target.value = "";
      Toast.success($t("audio_added_success"));
    }
    function handleChange(e) {
      var _a, _b;
      let uploadFile = (_b = (_a = e.target) == null ? void 0 : _a.files) == null ? void 0 : _b[0];
      if (!uploadFile) return;
      let reader = new FileReader();
      reader.readAsText(uploadFile, "UTF-8");
      reader.onload = function(e2) {
        let lrc = e2.target.result;
        console.log(lrc);
        if (lrc.trim()) {
          let lrcList = _parseLRC(lrc);
          console.log("lrcList", lrcList);
          if (lrcList.length) {
            editArticle.value.lrcPosition = editArticle.value.sections.map((v, i) => {
              return v.map((w, j) => {
                var _a2, _b2;
                for (let k = 0; k < lrcList.length; k++) {
                  let s = lrcList[k];
                  let d = Comparison.default.longestCommonSubsequence.similarity(w.text, s.text);
                  if (d >= 0.8) {
                    w.audioPosition = [s.start, (_a2 = s.end) != null ? _a2 : -1];
                    break;
                  }
                }
                return (_b2 = w.audioPosition) != null ? _b2 : [];
              });
            }).flat();
            Toast.success($t("lrc_parse_success"));
          }
        }
      };
      e.target.value = "";
    }
    let currentSentence = ref({});
    let editSentence = ref({});
    let preSentence = ref({});
    let showEditAudioDialog = ref(false);
    let showAudioDialog = ref(false);
    let showNameDialog = ref(false);
    let sentenceAudioRef = ref();
    let audioRef = ref();
    let nameListRef = ref([]);
    watch(
      () => showNameDialog.value,
      (v) => {
        if (v) {
          nameListRef.value = cloneDeep(Array.isArray(editArticle.value.nameList) ? editArticle.value.nameList : []);
          nameListRef.value.push("");
        }
      }
    );
    function addName() {
      nameListRef.value.push("");
    }
    function removeName(i) {
      nameListRef.value.splice(i, 1);
    }
    function saveNameList() {
      const cleaned = Array.from(new Set(nameListRef.value.map((s) => (s != null ? s : "").trim()).filter(Boolean)));
      editArticle.value.nameList = cleaned;
    }
    function handleShowEditAudioDialog(val, i, j) {
      var _a, _b;
      showEditAudioDialog.value = true;
      currentSentence.value = val;
      editSentence.value = cloneDeep(val);
      preSentence.value = null;
      audioRef.value.pause();
      if (j == 0) {
        if (i != 0) {
          preSentence.value = last(editArticle.value.sections[i - 1]);
        }
      } else {
        preSentence.value = editArticle.value.sections[i][j - 1];
      }
      if (!((_a = editSentence.value.audioPosition) == null ? void 0 : _a.length)) {
        editSentence.value.audioPosition = [0, 0];
        if (preSentence.value) {
          editSentence.value.audioPosition = [(_b = preSentence.value.audioPosition[1]) != null ? _b : 0, 0];
        }
      }
      _nextTick(() => {
        sentenceAudioRef.value.currentTime = editSentence.value.audioPosition[0];
      });
    }
    function recordStart() {
      if (sentenceAudioRef.value.paused) {
        sentenceAudioRef.value.play();
      }
      editSentence.value.audioPosition[0] = Number(sentenceAudioRef.value.currentTime.toFixed(2));
      if (editSentence.value.audioPosition[0] > editSentence.value.audioPosition[1] && editSentence.value.audioPosition[1] !== 0) {
        editSentence.value.audioPosition[1] = editSentence.value.audioPosition[0];
      }
    }
    function recordEnd() {
      if (!sentenceAudioRef.value.paused) {
        sentenceAudioRef.value.pause();
      }
      editSentence.value.audioPosition[1] = Number(sentenceAudioRef.value.currentTime.toFixed(2));
    }
    const { playSentenceAudio } = usePlaySentenceAudio();
    function saveLrcPosition() {
      currentSentence.value.audioPosition = cloneDeep(editSentence.value.audioPosition);
      editArticle.value.lrcPosition = editArticle.value.sections.map((v, i) => v.map((w, j) => {
        var _a;
        return (_a = w.audioPosition) != null ? _a : [];
      })).flat();
    }
    function jumpAudio(time) {
      sentenceAudioRef.value.currentTime = time;
    }
    function setPreEndTimeToCurrentStartTime() {
      if (preSentence.value) {
        editSentence.value.audioPosition[0] = preSentence.value.audioPosition[1];
      }
    }
    function setStartTime(val, i, j) {
      let preSentence2 = null;
      if (j == 0) {
        if (i != 0) {
          preSentence2 = last(editArticle.value.sections[i - 1]);
        }
      } else {
        preSentence2 = editArticle.value.sections[i][j - 1];
      }
      if (preSentence2) {
        val.audioPosition[0] = preSentence2.audioPosition[1];
      } else {
        val.audioPosition[0] = Number(Number(audioRef.value.currentTime).toFixed(2));
      }
      if (val.audioPosition[0] > val.audioPosition[1] && val.audioPosition[1] !== 0) {
        val.audioPosition[1] = 0;
      }
    }
    function setEndTime(val, i, j) {
      val.audioPosition[1] = Number(Number(audioRef.value.currentTime).toFixed(2));
      if (val.audioPosition[0] === 0) {
        setStartTime(val, i, j);
      }
    }
    function minusStartTime(val) {
      if (val.audioPosition[0] <= 0) return;
      val.audioPosition[0] = Number((val.audioPosition[0] - 0.3).toFixed(2));
    }
    return (_ctx, _push, _parent, _attrs) => {
      var _a, _b;
      const _component_IconFluentSettings20Regular = __unplugin_components_2$1;
      const _component_IconFluentQuestionCircle20Regular = __unplugin_components_5$1;
      const _component_IconIconParkOutlineAddMusic = __unplugin_components_2;
      const _component_IconFluentMyLocation20Regular = __unplugin_components_3;
      const _component_IconFluentPaddingLeft20Regular = __unplugin_components_4;
      const _component_IconFluentSpeakerEdit20Regular = __unplugin_components_5;
      const _component_IconFluentAddSquare20Regular = __unplugin_components_6;
      const _component_IconFluentPlay20Regular = __unplugin_components_7;
      const _component_IconFluentShieldQuestion20Regular = __unplugin_components_8;
      const _component_IconFluentCheckmarkCircle16Regular = __unplugin_components_9;
      _push(`<div${ssrRenderAttrs(mergeProps({ class: "content" }, _attrs))} data-v-2eecded7><div class="row flex flex-col gap-2" data-v-2eecded7><div class="title" data-v-2eecded7>${ssrInterpolate(unref($t)("original_text"))}</div><div class="flex gap-2 items-center" data-v-2eecded7><div class="shrink-0" data-v-2eecded7>${ssrInterpolate(unref($t)("title"))}\uFF1A</div>`);
      _push(ssrRenderComponent(BaseInput, {
        modelValue: unref(editArticle).title,
        "onUpdate:modelValue": ($event) => unref(editArticle).title = $event,
        disabled: ![100, 0].includes(unref(progress)),
        type: "text",
        placeholder: unref($t)("please_fill_original_title")
      }, null, _parent));
      _push(`</div><div class="flex justify-between" data-v-2eecded7><span data-v-2eecded7>${ssrInterpolate(unref($t)("content"))}\uFF1A<span class="text-sm color-gray" data-v-2eecded7>${ssrInterpolate(unref($t)("one_sentence_per_line"))}</span></span>`);
      _push(ssrRenderComponent(Tooltip, {
        title: unref($t)("name_config_tip")
      }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`<div class="center gap-1 cp" data-v-2eecded7${_scopeId}><span data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("name_config"))}</span>`);
            _push2(ssrRenderComponent(_component_IconFluentSettings20Regular, null, null, _parent2, _scopeId));
            _push2(`</div>`);
          } else {
            return [
              createVNode("div", {
                onClick: ($event) => isRef(showNameDialog) ? showNameDialog.value = true : showNameDialog = true,
                class: "center gap-1 cp"
              }, [
                createVNode("span", null, toDisplayString(unref($t)("name_config")), 1),
                createVNode(_component_IconFluentSettings20Regular)
              ], 8, ["onClick"])
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(`</div>`);
      _push(ssrRenderComponent(Textarea, {
        modelValue: unref(editArticle).text,
        "onUpdate:modelValue": ($event) => unref(editArticle).text = $event,
        class: "h-full",
        disabled: ![100, 0].includes(unref(progress)),
        placeholder: unref($t)("please_paste_original"),
        autosize: false
      }, null, _parent));
      _push(`<div class="justify-end items-center flex" data-v-2eecded7>`);
      _push(ssrRenderComponent(Tooltip, null, {
        reference: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`<div data-v-2eecded7${_scopeId}><div class="mb-2" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("usage_guide"))}</div><ol class="py-0 pl-5 my-0 text-base color-main" data-v-2eecded7${_scopeId}><li data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("copy_and_split"))}</li><li data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("click"))} <span class="color-red font-bold" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("split_sentence"))}</span> ${ssrInterpolate(unref($t)("auto_split"))}<span class="color-red font-bold" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("or"))}</span> ${ssrInterpolate(unref($t)("manual_split"))}</li><li data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("split_rule"))}</li><li data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("after_edit_click"))} <span class="color-red font-bold" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("apply"))}</span> ${ssrInterpolate(unref($t)("sync_to_result"))}</li></ol></div>`);
          } else {
            return [
              createVNode("div", null, [
                createVNode("div", { class: "mb-2" }, toDisplayString(unref($t)("usage_guide")), 1),
                createVNode("ol", { class: "py-0 pl-5 my-0 text-base color-main" }, [
                  createVNode("li", null, toDisplayString(unref($t)("copy_and_split")), 1),
                  createVNode("li", null, [
                    createTextVNode(toDisplayString(unref($t)("click")) + " ", 1),
                    createVNode("span", { class: "color-red font-bold" }, toDisplayString(unref($t)("split_sentence")), 1),
                    createTextVNode(" " + toDisplayString(unref($t)("auto_split")), 1),
                    createVNode("span", { class: "color-red font-bold" }, toDisplayString(unref($t)("or")), 1),
                    createTextVNode(" " + toDisplayString(unref($t)("manual_split")), 1)
                  ]),
                  createVNode("li", null, toDisplayString(unref($t)("split_rule")), 1),
                  createVNode("li", null, [
                    createTextVNode(toDisplayString(unref($t)("after_edit_click")) + " ", 1),
                    createVNode("span", { class: "color-red font-bold" }, toDisplayString(unref($t)("apply")), 1),
                    createTextVNode(" " + toDisplayString(unref($t)("sync_to_result")), 1)
                  ])
                ])
              ])
            ];
          }
        }),
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(ssrRenderComponent(_component_IconFluentQuestionCircle20Regular, {
              class: "mr-3",
              width: "20"
            }, null, _parent2, _scopeId));
          } else {
            return [
              createVNode(_component_IconFluentQuestionCircle20Regular, {
                class: "mr-3",
                width: "20"
              })
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(ssrRenderComponent(BaseButton, { onClick: splitText }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`${ssrInterpolate(unref($t)("split_sentence"))}`);
          } else {
            return [
              createTextVNode(toDisplayString(unref($t)("split_sentence")), 1)
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(ssrRenderComponent(BaseButton, {
        onClick: ($event) => apply()
      }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`${ssrInterpolate(unref($t)("apply"))}`);
          } else {
            return [
              createTextVNode(toDisplayString(unref($t)("apply")), 1)
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(`</div></div><div class="row flex flex-col gap-2" data-v-2eecded7><div class="title" data-v-2eecded7>${ssrInterpolate(unref($t)("translation"))}</div><div class="flex gap-2 items-center" data-v-2eecded7><div class="shrink-0" data-v-2eecded7>${ssrInterpolate(unref($t)("title"))}\uFF1A</div>`);
      _push(ssrRenderComponent(BaseInput, {
        modelValue: unref(editArticle).titleTranslate,
        "onUpdate:modelValue": ($event) => unref(editArticle).titleTranslate = $event,
        disabled: ![100, 0].includes(unref(progress)),
        type: "text",
        placeholder: unref($t)("please_fill_translation_title")
      }, null, _parent));
      _push(`</div><div class="" data-v-2eecded7>${ssrInterpolate(unref($t)("content"))}\uFF1A<span class="text-sm color-gray" data-v-2eecded7>${ssrInterpolate(unref($t)("one_sentence_per_line"))}</span></div>`);
      _push(ssrRenderComponent(Textarea, {
        modelValue: unref(editArticle).textTranslate,
        "onUpdate:modelValue": ($event) => unref(editArticle).textTranslate = $event,
        class: "h-full",
        disabled: ![100, 0].includes(unref(progress)),
        placeholder: unref($t)("please_fill_translation"),
        autosize: false
      }, null, _parent));
      _push(`<div class="justify-between items-center flex" data-v-2eecded7><div class="flex gap-space items-center w-50" data-v-2eecded7>`);
      _push(ssrRenderComponent(BaseButton, {
        onClick: startNetworkTranslate,
        loading: unref(progress) !== 0 && unref(progress) !== 100
      }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`${ssrInterpolate(unref($t)("translate"))}`);
          } else {
            return [
              createTextVNode(toDisplayString(unref($t)("translate")), 1)
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(ssrRenderComponent(Select, {
        modelValue: unref(networkTranslateEngine),
        "onUpdate:modelValue": ($event) => isRef(networkTranslateEngine) ? networkTranslateEngine.value = $event : networkTranslateEngine = $event
      }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`<!--[-->`);
            ssrRenderList(TranslateEngineOptions, (item) => {
              _push2(ssrRenderComponent(Option, {
                key: item.value,
                label: item.label,
                value: item.value
              }, null, _parent2, _scopeId));
            });
            _push2(`<!--]-->`);
          } else {
            return [
              (openBlock(), createBlock(Fragment, null, renderList(TranslateEngineOptions, (item) => {
                return createVNode(Option, {
                  key: item.value,
                  label: item.label,
                  value: item.value
                }, null, 8, ["label", "value"]);
              }), 64))
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(` ${ssrInterpolate(unref(progress))}% </div><div class="flex items-center" data-v-2eecded7>`);
      _push(ssrRenderComponent(Tooltip, null, {
        reference: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`<div data-v-2eecded7${_scopeId}><div class="mb-2" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("usage_guide"))}</div><ol class="py-0 pl-5 my-0 text-base color-black/60" data-v-2eecded7${_scopeId}><li data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("copy_translation_or_click"))} <span class="color-red font-bold" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("translate"))}</span></li><li data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("click"))} <span class="color-red font-bold" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("split_sentence"))}</span> ${ssrInterpolate(unref($t)("auto_split"))}<span class="color-red font-bold" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("or"))}</span> ${ssrInterpolate(unref($t)("manual_split"))}</li><li data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("split_rule"))}</li><li data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("after_edit_click"))} <span class="color-red font-bold" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("apply"))}</span> ${ssrInterpolate(unref($t)("sync_to_result"))}</li></ol></div>`);
          } else {
            return [
              createVNode("div", null, [
                createVNode("div", { class: "mb-2" }, toDisplayString(unref($t)("usage_guide")), 1),
                createVNode("ol", { class: "py-0 pl-5 my-0 text-base color-black/60" }, [
                  createVNode("li", null, [
                    createTextVNode(toDisplayString(unref($t)("copy_translation_or_click")) + " ", 1),
                    createVNode("span", { class: "color-red font-bold" }, toDisplayString(unref($t)("translate")), 1)
                  ]),
                  createVNode("li", null, [
                    createTextVNode(toDisplayString(unref($t)("click")) + " ", 1),
                    createVNode("span", { class: "color-red font-bold" }, toDisplayString(unref($t)("split_sentence")), 1),
                    createTextVNode(" " + toDisplayString(unref($t)("auto_split")), 1),
                    createVNode("span", { class: "color-red font-bold" }, toDisplayString(unref($t)("or")), 1),
                    createTextVNode(" " + toDisplayString(unref($t)("manual_split")), 1)
                  ]),
                  createVNode("li", null, toDisplayString(unref($t)("split_rule")), 1),
                  createVNode("li", null, [
                    createTextVNode(toDisplayString(unref($t)("after_edit_click")) + " ", 1),
                    createVNode("span", { class: "color-red font-bold" }, toDisplayString(unref($t)("apply")), 1),
                    createTextVNode(" " + toDisplayString(unref($t)("sync_to_result")), 1)
                  ])
                ])
              ])
            ];
          }
        }),
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(ssrRenderComponent(_component_IconFluentQuestionCircle20Regular, {
              class: "mr-3",
              width: "20"
            }, null, _parent2, _scopeId));
          } else {
            return [
              createVNode(_component_IconFluentQuestionCircle20Regular, {
                class: "mr-3",
                width: "20"
              })
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(ssrRenderComponent(BaseButton, { onClick: splitTranslateText }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`${ssrInterpolate(unref($t)("split_sentence"))}`);
          } else {
            return [
              createTextVNode(toDisplayString(unref($t)("split_sentence")), 1)
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(ssrRenderComponent(BaseButton, {
        onClick: ($event) => apply(true)
      }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`${ssrInterpolate(unref($t)("apply"))}`);
          } else {
            return [
              createTextVNode(toDisplayString(unref($t)("apply")), 1)
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(`</div></div></div><div class="row flex flex-col gap-2" data-v-2eecded7><div class="flex gap-2" data-v-2eecded7><div class="title" data-v-2eecded7>${ssrInterpolate(unref($t)("result"))}</div><div class="flex gap-2 flex-1 justify-end" data-v-2eecded7>`);
      _push(ssrRenderComponent(ArticleAudio, {
        ref_key: "audioRef",
        ref: audioRef,
        article: unref(editArticle),
        autoplay: false
      }, null, _parent));
      _push(`</div></div>`);
      if ((_b = (_a = unref(editArticle)) == null ? void 0 : _a.sections) == null ? void 0 : _b.length) {
        _push(`<!--[--><div class="flex-1 overflow-auto flex flex-col" data-v-2eecded7><div class="flex justify-between bg-black/10 py-2 rounded-lt-md rounded-rt-md" data-v-2eecded7><div class="center flex-[7]" data-v-2eecded7>${ssrInterpolate(unref($t)("content"))}( <span class="text-sm color-gray-500" data-v-2eecded7>${ssrInterpolate(unref($t)("editable_auto_sync"))}</span>) </div><div data-v-2eecded7>|</div><div class="center flex-[3] gap-2" data-v-2eecded7><span data-v-2eecded7>${ssrInterpolate(unref($t)("audio"))}</span>`);
        _push(ssrRenderComponent(BaseIcon, {
          title: unref($t)("audio_management"),
          onClick: ($event) => isRef(showAudioDialog) ? showAudioDialog.value = true : showAudioDialog = true
        }, {
          default: withCtx((_, _push2, _parent2, _scopeId) => {
            if (_push2) {
              _push2(ssrRenderComponent(_component_IconIconParkOutlineAddMusic, null, null, _parent2, _scopeId));
            } else {
              return [
                createVNode(_component_IconIconParkOutlineAddMusic)
              ];
            }
          }),
          _: 1
        }, _parent));
        _push(`</div></div><div class="article-translate" data-v-2eecded7><!--[-->`);
        ssrRenderList(unref(editArticle).sections, (item, indexI) => {
          _push(`<div class="section rounded-md" data-v-2eecded7><div class="section-title text-lg font-bold" data-v-2eecded7>${ssrInterpolate(unref($t)("paragraph"))}${ssrInterpolate(indexI + 1)}</div><!--[-->`);
          ssrRenderList(item, (sentence, indexJ) => {
            var _a2, _b2, _c, _d, _e, _f, _g;
            _push(`<div class="sentence" data-v-2eecded7><div class="flex-[7]" data-v-2eecded7>`);
            _push(ssrRenderComponent(EditAbleText, {
              disabled: ![100, 0].includes(unref(progress)),
              value: sentence.text,
              onSave: (e) => saveSentenceText(sentence, e)
            }, null, _parent));
            if (sentence.translate) {
              _push(ssrRenderComponent(EditAbleText, {
                class: "text-lg!",
                disabled: ![100, 0].includes(unref(progress)),
                value: sentence.translate,
                onSave: (e) => saveSentenceTranslate(sentence, e)
              }, null, _parent));
            } else {
              _push(`<!---->`);
            }
            _push(`</div><div class="flex-[2] flex justify-end gap-1 items-center" data-v-2eecded7><div class="flex justify-end gap-2" data-v-2eecded7><div class="flex flex-col items-center justify-center" data-v-2eecded7><div data-v-2eecded7>${ssrInterpolate((_b2 = (_a2 = sentence.audioPosition) == null ? void 0 : _a2[0]) != null ? _b2 : 0)}s</div><div class="flex gap-1" data-v-2eecded7>`);
            _push(ssrRenderComponent(BaseIcon, {
              onClick: ($event) => setStartTime(sentence, indexI, indexJ),
              title: indexI === 0 && indexJ === 0 ? unref($t)("set_start_time") : unref($t)("use_prev_end_time")
            }, {
              default: withCtx((_, _push2, _parent2, _scopeId) => {
                if (_push2) {
                  if (indexI === 0 && indexJ === 0) {
                    _push2(ssrRenderComponent(_component_IconFluentMyLocation20Regular, null, null, _parent2, _scopeId));
                  } else {
                    _push2(ssrRenderComponent(_component_IconFluentPaddingLeft20Regular, null, null, _parent2, _scopeId));
                  }
                } else {
                  return [
                    indexI === 0 && indexJ === 0 ? (openBlock(), createBlock(_component_IconFluentMyLocation20Regular, { key: 0 })) : (openBlock(), createBlock(_component_IconFluentPaddingLeft20Regular, { key: 1 }))
                  ];
                }
              }),
              _: 2
            }, _parent));
            _push(ssrRenderComponent(BaseIcon, {
              onClick: ($event) => minusStartTime(sentence),
              title: unref($t)("minus_03s")
            }, {
              default: withCtx((_, _push2, _parent2, _scopeId) => {
                if (_push2) {
                  _push2(` -.3s `);
                } else {
                  return [
                    createTextVNode(" -.3s ")
                  ];
                }
              }),
              _: 2
            }, _parent));
            _push(`</div></div><div data-v-2eecded7>-</div><div class="flex flex-col items-center justify-center" data-v-2eecded7>`);
            if (((_c = sentence.audioPosition) == null ? void 0 : _c[1]) !== -1) {
              _push(`<div data-v-2eecded7>${ssrInterpolate((_e = (_d = sentence.audioPosition) == null ? void 0 : _d[1]) != null ? _e : 0)}s</div>`);
            } else {
              _push(`<div data-v-2eecded7>${ssrInterpolate(unref($t)("end"))}</div>`);
            }
            _push(ssrRenderComponent(BaseIcon, {
              onClick: ($event) => setEndTime(sentence, indexI, indexJ),
              title: unref($t)("set_end_time")
            }, {
              default: withCtx((_, _push2, _parent2, _scopeId) => {
                if (_push2) {
                  _push2(ssrRenderComponent(_component_IconFluentMyLocation20Regular, null, null, _parent2, _scopeId));
                } else {
                  return [
                    createVNode(_component_IconFluentMyLocation20Regular)
                  ];
                }
              }),
              _: 2
            }, _parent));
            _push(`</div></div><div class="flex flex-col" data-v-2eecded7>`);
            _push(ssrRenderComponent(BaseIcon, {
              icon: ((_f = sentence.audioPosition) == null ? void 0 : _f.length) ? "basil:edit-outline" : "basil:add-outline",
              title: unref($t)("edit_audio_align"),
              onClick: ($event) => handleShowEditAudioDialog(sentence, indexI, indexJ)
            }, {
              default: withCtx((_, _push2, _parent2, _scopeId) => {
                var _a3, _b3;
                if (_push2) {
                  if (((_a3 = sentence.audioPosition) == null ? void 0 : _a3.length) && sentence.audioPosition[1]) {
                    _push2(ssrRenderComponent(_component_IconFluentSpeakerEdit20Regular, null, null, _parent2, _scopeId));
                  } else {
                    _push2(ssrRenderComponent(_component_IconFluentAddSquare20Regular, null, null, _parent2, _scopeId));
                  }
                } else {
                  return [
                    ((_b3 = sentence.audioPosition) == null ? void 0 : _b3.length) && sentence.audioPosition[1] ? (openBlock(), createBlock(_component_IconFluentSpeakerEdit20Regular, { key: 0 })) : (openBlock(), createBlock(_component_IconFluentAddSquare20Regular, { key: 1 }))
                  ];
                }
              }),
              _: 2
            }, _parent));
            if ((_g = sentence.audioPosition) == null ? void 0 : _g.length) {
              _push(ssrRenderComponent(BaseIcon, {
                title: unref($t)("play"),
                onClick: ($event) => unref(playSentenceAudio)(sentence, unref(audioRef))
              }, {
                default: withCtx((_, _push2, _parent2, _scopeId) => {
                  if (_push2) {
                    _push2(ssrRenderComponent(_component_IconFluentPlay20Regular, null, null, _parent2, _scopeId));
                  } else {
                    return [
                      createVNode(_component_IconFluentPlay20Regular)
                    ];
                  }
                }),
                _: 2
              }, _parent));
            } else {
              _push(`<!---->`);
            }
            _push(`</div></div></div>`);
          });
          _push(`<!--]--></div>`);
        });
        _push(`<!--]--></div></div>`);
        if (unref(editArticle).text.trim()) {
          _push(`<div class="options" data-v-2eecded7><div class="status" data-v-2eecded7><span data-v-2eecded7>${ssrInterpolate(unref($t)("status"))}\uFF1A</span>`);
          if (unref(failCount)) {
            _push(`<div class="warning" data-v-2eecded7>`);
            _push(ssrRenderComponent(_component_IconFluentShieldQuestion20Regular, null, null, _parent));
            _push(` ${ssrInterpolate(unref($t)("sentences_not_translated", { count: unref(failCount) }))}</div>`);
          } else {
            _push(`<div class="success" data-v-2eecded7>`);
            _push(ssrRenderComponent(_component_IconFluentCheckmarkCircle16Regular, null, null, _parent));
            _push(` ${ssrInterpolate(unref($t)("translation_complete"))}</div>`);
          }
          _push(`</div><div data-v-2eecded7>`);
          _push(ssrRenderComponent(BaseButton, {
            onClick: ($event) => save("save")
          }, {
            default: withCtx((_, _push2, _parent2, _scopeId) => {
              if (_push2) {
                _push2(`${ssrInterpolate(unref($t)("save"))}`);
              } else {
                return [
                  createTextVNode(toDisplayString(unref($t)("save")), 1)
                ];
              }
            }),
            _: 1
          }, _parent));
          if (__props.type === "batch") {
            _push(ssrRenderComponent(BaseButton, {
              onClick: ($event) => save("saveAndNext")
            }, {
              default: withCtx((_, _push2, _parent2, _scopeId) => {
                if (_push2) {
                  _push2(`${ssrInterpolate(unref($t)("save_and_next"))}`);
                } else {
                  return [
                    createTextVNode(toDisplayString(unref($t)("save_and_next")), 1)
                  ];
                }
              }),
              _: 1
            }, _parent));
          } else {
            _push(`<!---->`);
          }
          _push(`</div></div>`);
        } else {
          _push(`<!---->`);
        }
        _push(`<!--]-->`);
      } else {
        _push(ssrRenderComponent(Empty, {
          text: unref($t)("no_translation_comparison")
        }, null, _parent));
      }
      _push(`</div>`);
      _push(ssrRenderComponent(unref(Dialog), {
        title: unref($t)("adjust_audio_timeline"),
        modelValue: unref(showEditAudioDialog),
        "onUpdate:modelValue": ($event) => isRef(showEditAudioDialog) ? showEditAudioDialog.value = $event : showEditAudioDialog = $event,
        footer: true,
        onClose: ($event) => isRef(showEditAudioDialog) ? showEditAudioDialog.value = false : showEditAudioDialog = false,
        onOk: saveLrcPosition
      }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          var _a2, _b2, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l;
          if (_push2) {
            _push2(`<div class="p-4 pt-0 color-main w-150 flex flex-col gap-2" data-v-2eecded7${_scopeId}><div class="" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("audio_timeline_tutorial"))}</div>`);
            _push2(ssrRenderComponent(ArticleAudio, {
              ref_key: "sentenceAudioRef",
              ref: sentenceAudioRef,
              article: unref(editArticle),
              autoplay: false,
              class: "w-full"
            }, null, _parent2, _scopeId));
            if ((_a2 = unref(editSentence).audioPosition) == null ? void 0 : _a2.length) {
              _push2(`<div class="flex items-center gap-2 justify-between mb-2" data-v-2eecded7${_scopeId}><div data-v-2eecded7${_scopeId}>${ssrInterpolate(unref(editSentence).text)}</div><div class="flex items-center gap-2 shrink-0" data-v-2eecded7${_scopeId}><div data-v-2eecded7${_scopeId}><span data-v-2eecded7${_scopeId}>${ssrInterpolate((_b2 = unref(editSentence).audioPosition) == null ? void 0 : _b2[0])}s</span>`);
              if (((_c = unref(editSentence).audioPosition) == null ? void 0 : _c[1]) !== -1) {
                _push2(`<span data-v-2eecded7${_scopeId}> - ${ssrInterpolate((_d = unref(editSentence).audioPosition) == null ? void 0 : _d[1])}s</span>`);
              } else {
                _push2(`<span data-v-2eecded7${_scopeId}> - ${ssrInterpolate(unref($t)("end"))}</span>`);
              }
              _push2(`</div>`);
              _push2(ssrRenderComponent(BaseIcon, {
                title: unref($t)("play"),
                onClick: ($event) => unref(playSentenceAudio)(unref(editSentence), unref(sentenceAudioRef))
              }, {
                default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                  if (_push3) {
                    _push3(ssrRenderComponent(_component_IconFluentPlay20Regular, null, null, _parent3, _scopeId2));
                  } else {
                    return [
                      createVNode(_component_IconFluentPlay20Regular)
                    ];
                  }
                }),
                _: 1
              }, _parent2, _scopeId));
              _push2(`</div></div>`);
            } else {
              _push2(`<!---->`);
            }
            _push2(`<div class="flex flex-col gap-2" data-v-2eecded7${_scopeId}><div class="flex gap-2 items-center" data-v-2eecded7${_scopeId}><div data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("start_time"))}\uFF1A</div><div class="flex justify-between flex-1" data-v-2eecded7${_scopeId}><div class="flex items-center gap-2" data-v-2eecded7${_scopeId}>`);
            _push2(ssrRenderComponent(InputNumber, {
              modelValue: unref(editSentence).audioPosition[0],
              "onUpdate:modelValue": ($event) => unref(editSentence).audioPosition[0] = $event,
              precision: 2,
              step: 0.1
            }, null, _parent2, _scopeId));
            _push2(ssrRenderComponent(BaseIcon, {
              onClick: ($event) => jumpAudio(unref(editSentence).audioPosition[0]),
              title: unref($t)("jump_to_seconds", { seconds: unref(editSentence).audioPosition[0] })
            }, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(ssrRenderComponent(_component_IconFluentMyLocation20Regular, null, null, _parent3, _scopeId2));
                } else {
                  return [
                    createVNode(_component_IconFluentMyLocation20Regular)
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
            if (unref(preSentence)) {
              _push2(ssrRenderComponent(BaseIcon, {
                onClick: setPreEndTimeToCurrentStartTime,
                title: unref($t)("use_prev_end_seconds", { seconds: ((_f = (_e = unref(preSentence)) == null ? void 0 : _e.audioPosition) == null ? void 0 : _f[1]) || 0 })
              }, {
                default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                  if (_push3) {
                    _push3(ssrRenderComponent(_component_IconFluentPaddingLeft20Regular, null, null, _parent3, _scopeId2));
                  } else {
                    return [
                      createVNode(_component_IconFluentPaddingLeft20Regular)
                    ];
                  }
                }),
                _: 1
              }, _parent2, _scopeId));
            } else {
              _push2(`<!---->`);
            }
            _push2(ssrRenderComponent(BaseIcon, {
              onClick: ($event) => unref(editSentence).audioPosition[0] = Number((unref(editSentence).audioPosition[0] - 0.3).toFixed(2)),
              title: unref($t)("decrease_03s")
            }, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(` -.3s `);
                } else {
                  return [
                    createTextVNode(" -.3s ")
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
            _push2(ssrRenderComponent(BaseIcon, {
              onClick: ($event) => unref(editSentence).audioPosition[0] = Number((unref(editSentence).audioPosition[0] + 0.3).toFixed(2)),
              title: unref($t)("increase_03s")
            }, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(` +.3s `);
                } else {
                  return [
                    createTextVNode(" +.3s ")
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
            _push2(`</div>`);
            _push2(ssrRenderComponent(BaseButton, { onClick: recordStart }, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(`${ssrInterpolate(unref($t)("record"))}`);
                } else {
                  return [
                    createTextVNode(toDisplayString(unref($t)("record")), 1)
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
            _push2(`</div></div><div class="flex gap-2 items-center" data-v-2eecded7${_scopeId}><div data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("end_time"))}\uFF1A</div><div class="flex justify-between flex-1" data-v-2eecded7${_scopeId}><div class="flex items-center gap-2" data-v-2eecded7${_scopeId}>`);
            _push2(ssrRenderComponent(InputNumber, {
              modelValue: unref(editSentence).audioPosition[1],
              "onUpdate:modelValue": ($event) => unref(editSentence).audioPosition[1] = $event,
              precision: 2,
              step: 0.1
            }, null, _parent2, _scopeId));
            _push2(`<span data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("or"))}</span>`);
            _push2(ssrRenderComponent(BaseButton, {
              size: "small",
              onClick: ($event) => unref(editSentence).audioPosition[1] = -1
            }, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(`${ssrInterpolate(unref($t)("end"))}`);
                } else {
                  return [
                    createTextVNode(toDisplayString(unref($t)("end")), 1)
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
            _push2(`</div>`);
            _push2(ssrRenderComponent(BaseButton, { onClick: recordEnd }, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(`${ssrInterpolate(unref($t)("record"))}`);
                } else {
                  return [
                    createTextVNode(toDisplayString(unref($t)("record")), 1)
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
            _push2(`</div></div></div></div>`);
          } else {
            return [
              createVNode("div", { class: "p-4 pt-0 color-main w-150 flex flex-col gap-2" }, [
                createVNode("div", { class: "" }, toDisplayString(unref($t)("audio_timeline_tutorial")), 1),
                createVNode(ArticleAudio, {
                  ref_key: "sentenceAudioRef",
                  ref: sentenceAudioRef,
                  article: unref(editArticle),
                  autoplay: false,
                  class: "w-full"
                }, null, 8, ["article"]),
                ((_g = unref(editSentence).audioPosition) == null ? void 0 : _g.length) ? (openBlock(), createBlock("div", {
                  key: 0,
                  class: "flex items-center gap-2 justify-between mb-2"
                }, [
                  createVNode("div", null, toDisplayString(unref(editSentence).text), 1),
                  createVNode("div", { class: "flex items-center gap-2 shrink-0" }, [
                    createVNode("div", null, [
                      createVNode("span", null, toDisplayString((_h = unref(editSentence).audioPosition) == null ? void 0 : _h[0]) + "s", 1),
                      ((_i = unref(editSentence).audioPosition) == null ? void 0 : _i[1]) !== -1 ? (openBlock(), createBlock("span", { key: 0 }, " - " + toDisplayString((_j = unref(editSentence).audioPosition) == null ? void 0 : _j[1]) + "s", 1)) : (openBlock(), createBlock("span", { key: 1 }, " - " + toDisplayString(unref($t)("end")), 1))
                    ]),
                    createVNode(BaseIcon, {
                      title: unref($t)("play"),
                      onClick: ($event) => unref(playSentenceAudio)(unref(editSentence), unref(sentenceAudioRef))
                    }, {
                      default: withCtx(() => [
                        createVNode(_component_IconFluentPlay20Regular)
                      ]),
                      _: 1
                    }, 8, ["title", "onClick"])
                  ])
                ])) : createCommentVNode("", true),
                createVNode("div", { class: "flex flex-col gap-2" }, [
                  createVNode("div", { class: "flex gap-2 items-center" }, [
                    createVNode("div", null, toDisplayString(unref($t)("start_time")) + "\uFF1A", 1),
                    createVNode("div", { class: "flex justify-between flex-1" }, [
                      createVNode("div", { class: "flex items-center gap-2" }, [
                        createVNode(InputNumber, {
                          modelValue: unref(editSentence).audioPosition[0],
                          "onUpdate:modelValue": ($event) => unref(editSentence).audioPosition[0] = $event,
                          precision: 2,
                          step: 0.1
                        }, null, 8, ["modelValue", "onUpdate:modelValue"]),
                        createVNode(BaseIcon, {
                          onClick: ($event) => jumpAudio(unref(editSentence).audioPosition[0]),
                          title: unref($t)("jump_to_seconds", { seconds: unref(editSentence).audioPosition[0] })
                        }, {
                          default: withCtx(() => [
                            createVNode(_component_IconFluentMyLocation20Regular)
                          ]),
                          _: 1
                        }, 8, ["onClick", "title"]),
                        unref(preSentence) ? (openBlock(), createBlock(BaseIcon, {
                          key: 0,
                          onClick: setPreEndTimeToCurrentStartTime,
                          title: unref($t)("use_prev_end_seconds", { seconds: ((_l = (_k = unref(preSentence)) == null ? void 0 : _k.audioPosition) == null ? void 0 : _l[1]) || 0 })
                        }, {
                          default: withCtx(() => [
                            createVNode(_component_IconFluentPaddingLeft20Regular)
                          ]),
                          _: 1
                        }, 8, ["title"])) : createCommentVNode("", true),
                        createVNode(BaseIcon, {
                          onClick: ($event) => unref(editSentence).audioPosition[0] = Number((unref(editSentence).audioPosition[0] - 0.3).toFixed(2)),
                          title: unref($t)("decrease_03s")
                        }, {
                          default: withCtx(() => [
                            createTextVNode(" -.3s ")
                          ]),
                          _: 1
                        }, 8, ["onClick", "title"]),
                        createVNode(BaseIcon, {
                          onClick: ($event) => unref(editSentence).audioPosition[0] = Number((unref(editSentence).audioPosition[0] + 0.3).toFixed(2)),
                          title: unref($t)("increase_03s")
                        }, {
                          default: withCtx(() => [
                            createTextVNode(" +.3s ")
                          ]),
                          _: 1
                        }, 8, ["onClick", "title"])
                      ]),
                      createVNode(BaseButton, { onClick: recordStart }, {
                        default: withCtx(() => [
                          createTextVNode(toDisplayString(unref($t)("record")), 1)
                        ]),
                        _: 1
                      })
                    ])
                  ]),
                  createVNode("div", { class: "flex gap-2 items-center" }, [
                    createVNode("div", null, toDisplayString(unref($t)("end_time")) + "\uFF1A", 1),
                    createVNode("div", { class: "flex justify-between flex-1" }, [
                      createVNode("div", { class: "flex items-center gap-2" }, [
                        createVNode(InputNumber, {
                          modelValue: unref(editSentence).audioPosition[1],
                          "onUpdate:modelValue": ($event) => unref(editSentence).audioPosition[1] = $event,
                          precision: 2,
                          step: 0.1
                        }, null, 8, ["modelValue", "onUpdate:modelValue"]),
                        createVNode("span", null, toDisplayString(unref($t)("or")), 1),
                        createVNode(BaseButton, {
                          size: "small",
                          onClick: ($event) => unref(editSentence).audioPosition[1] = -1
                        }, {
                          default: withCtx(() => [
                            createTextVNode(toDisplayString(unref($t)("end")), 1)
                          ]),
                          _: 1
                        }, 8, ["onClick"])
                      ]),
                      createVNode(BaseButton, { onClick: recordEnd }, {
                        default: withCtx(() => [
                          createTextVNode(toDisplayString(unref($t)("record")), 1)
                        ]),
                        _: 1
                      })
                    ])
                  ])
                ])
              ])
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(ssrRenderComponent(unref(Dialog), {
        title: unref($t)("audio_management"),
        modelValue: unref(showAudioDialog),
        "onUpdate:modelValue": ($event) => isRef(showAudioDialog) ? showAudioDialog.value = $event : showAudioDialog = $event,
        footer: false,
        onClose: ($event) => isRef(showAudioDialog) ? showAudioDialog.value = false : showAudioDialog = false
      }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`<div class="p-4 pt-0 color-main w-150 flex flex-col gap-2" data-v-2eecded7${_scopeId}><div class="" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("audio_upload_notice"))}</div><div class="upload relative" data-v-2eecded7${_scopeId}>`);
            _push2(ssrRenderComponent(BaseButton, null, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(`${ssrInterpolate(unref($t)("upload_audio"))}`);
                } else {
                  return [
                    createTextVNode(toDisplayString(unref($t)("upload_audio")), 1)
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
            _push2(`<input type="file" accept="audio/*" class="w-full h-full absolute left-0 top-0 opacity-0" data-v-2eecded7${_scopeId}></div><div class="upload relative" data-v-2eecded7${_scopeId}>`);
            _push2(ssrRenderComponent(BaseButton, null, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(`${ssrInterpolate(unref($t)("upload_lrc"))}`);
                } else {
                  return [
                    createTextVNode(toDisplayString(unref($t)("upload_lrc")), 1)
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
            _push2(`<input type="file" accept=".lrc" class="w-full h-full absolute left-0 top-0 opacity-0" data-v-2eecded7${_scopeId}></div></div>`);
          } else {
            return [
              createVNode("div", { class: "p-4 pt-0 color-main w-150 flex flex-col gap-2" }, [
                createVNode("div", { class: "" }, toDisplayString(unref($t)("audio_upload_notice")), 1),
                createVNode("div", { class: "upload relative" }, [
                  createVNode(BaseButton, null, {
                    default: withCtx(() => [
                      createTextVNode(toDisplayString(unref($t)("upload_audio")), 1)
                    ]),
                    _: 1
                  }),
                  createVNode("input", {
                    type: "file",
                    accept: "audio/*",
                    onChange: handleAudioChange,
                    class: "w-full h-full absolute left-0 top-0 opacity-0"
                  }, null, 32)
                ]),
                createVNode("div", { class: "upload relative" }, [
                  createVNode(BaseButton, null, {
                    default: withCtx(() => [
                      createTextVNode(toDisplayString(unref($t)("upload_lrc")), 1)
                    ]),
                    _: 1
                  }),
                  createVNode("input", {
                    type: "file",
                    accept: ".lrc",
                    onChange: handleChange,
                    class: "w-full h-full absolute left-0 top-0 opacity-0"
                  }, null, 32)
                ])
              ])
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(ssrRenderComponent(unref(Dialog), {
        title: unref($t)("name_management"),
        modelValue: unref(showNameDialog),
        "onUpdate:modelValue": ($event) => isRef(showNameDialog) ? showNameDialog.value = $event : showNameDialog = $event,
        footer: true,
        onClose: ($event) => isRef(showNameDialog) ? showNameDialog.value = false : showNameDialog = false,
        onOk: saveNameList
      }, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`<div class="p-4 pt-0 color-main w-150 flex flex-col gap-3" data-v-2eecded7${_scopeId}><div class="flex justify-between items-center" data-v-2eecded7${_scopeId}><div class="text-base" data-v-2eecded7${_scopeId}>${ssrInterpolate(unref($t)("name_ignore_config_desc"))}</div>`);
            _push2(ssrRenderComponent(BaseButton, {
              type: "info",
              onClick: addName
            }, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(`${ssrInterpolate(unref($t)("add_name"))}`);
                } else {
                  return [
                    createTextVNode(toDisplayString(unref($t)("add_name")), 1)
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
            _push2(`</div><div class="flex flex-col gap-2" data-v-2eecded7${_scopeId}><!--[-->`);
            ssrRenderList(unref(nameListRef), (name, i) => {
              _push2(`<div class="flex items-center gap-2" data-v-2eecded7${_scopeId}>`);
              _push2(ssrRenderComponent(BaseInput, {
                modelValue: unref(nameListRef)[i],
                "onUpdate:modelValue": ($event) => unref(nameListRef)[i] = $event,
                placeholder: unref($t)("enter_name"),
                size: "large",
                autofocus: i === unref(nameListRef).length - 1
              }, null, _parent2, _scopeId));
              _push2(ssrRenderComponent(BaseButton, {
                type: "info",
                onClick: ($event) => removeName(i)
              }, {
                default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                  if (_push3) {
                    _push3(`${ssrInterpolate(unref($t)("delete"))}`);
                  } else {
                    return [
                      createTextVNode(toDisplayString(unref($t)("delete")), 1)
                    ];
                  }
                }),
                _: 2
              }, _parent2, _scopeId));
              _push2(`</div>`);
            });
            _push2(`<!--]--></div></div>`);
          } else {
            return [
              createVNode("div", { class: "p-4 pt-0 color-main w-150 flex flex-col gap-3" }, [
                createVNode("div", { class: "flex justify-between items-center" }, [
                  createVNode("div", { class: "text-base" }, toDisplayString(unref($t)("name_ignore_config_desc")), 1),
                  createVNode(BaseButton, {
                    type: "info",
                    onClick: addName
                  }, {
                    default: withCtx(() => [
                      createTextVNode(toDisplayString(unref($t)("add_name")), 1)
                    ]),
                    _: 1
                  })
                ]),
                createVNode("div", { class: "flex flex-col gap-2" }, [
                  (openBlock(true), createBlock(Fragment, null, renderList(unref(nameListRef), (name, i) => {
                    return openBlock(), createBlock("div", {
                      class: "flex items-center gap-2",
                      key: i
                    }, [
                      createVNode(BaseInput, {
                        modelValue: unref(nameListRef)[i],
                        "onUpdate:modelValue": ($event) => unref(nameListRef)[i] = $event,
                        placeholder: unref($t)("enter_name"),
                        size: "large",
                        autofocus: i === unref(nameListRef).length - 1
                      }, null, 8, ["modelValue", "onUpdate:modelValue", "placeholder", "autofocus"]),
                      createVNode(BaseButton, {
                        type: "info",
                        onClick: ($event) => removeName(i)
                      }, {
                        default: withCtx(() => [
                          createTextVNode(toDisplayString(unref($t)("delete")), 1)
                        ]),
                        _: 1
                      }, 8, ["onClick"])
                    ]);
                  }), 128))
                ])
              ])
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(`</div>`);
    };
  }
});
const _sfc_setup = _sfc_main.setup;
_sfc_main.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("components/article/EditArticle.vue");
  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;
};
const EditArticle = /* @__PURE__ */ Object.assign(_export_sfc(_sfc_main, [["__scopeId", "data-v-2eecded7"]]), { __name: "EditArticle" });

export { EditArticle as E, genArticleSectionData as g, syncBookInMyStudyList as s, usePlaySentenceAudio as u };
//# sourceMappingURL=EditArticle-CDTYchLT.mjs.map
