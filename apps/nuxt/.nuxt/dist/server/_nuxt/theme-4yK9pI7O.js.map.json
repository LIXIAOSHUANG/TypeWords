{"file":"theme-4yK9pI7O.js","mappings":";AAKO,SAAS,iBAAwB;AACd,SAAO;AAOjC;AAGO,SAAS,UAAU,OAAqB;AAC7C,SAAO,UAAU,UAAU,SAAS;AACtC;AAmBO,SAAS,SAAS,KAAa;AAKtC;AAEA,SAAwB,WAAW;AACjC,QAAM,eAAe,gBAAA;AAarB,WAAS,cAAc;AAErB,iBAAa,QAAQ,UAAU,aAAa,UAAU,SAAS,eAAA,IAAoB,aAAa,KAAe;AAC/G,aAAS,aAAa,KAAK;AAAA,EAC7B;AAGA,WAAS,WAAkB;AAEzB,WAAO,aAAa,UAAU,SAAS,eAAA,IAAoB,aAAa;AAAA,EAC1E;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ;","names":[],"sources":["../../../../app/hooks/theme.ts"],"sourcesContent":["import { useSettingStore } from '@/stores/setting.ts'\n\ntype Theme = 'light' | 'dark'\n\n// 获取系统主题\nexport function getSystemTheme(): Theme {\n  if (import.meta.server) return 'light'\n  if (window.matchMedia('(prefers-color-scheme: dark)').matches) {\n    return 'dark'\n  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {\n    return 'light'\n  }\n  return 'light' // 默认浅色模式\n}\n\n// 交换主题名称\nexport function swapTheme(theme: Theme): Theme {\n  return theme === 'light' ? 'dark' : 'light'\n}\n\n// 监听系统主题变化\nexport function listenToSystemThemeChange(call: (theme: Theme) => void) {\n  if (import.meta.server) return\n  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {\n    if (e.matches) {\n      // console.log('系统已切换到深色模式');\n      call('dark')\n    }\n  })\n  window.matchMedia('(prefers-color-scheme: light)').addEventListener('change', e => {\n    if (e.matches) {\n      // console.log('系统已切换到浅色模式');\n      call('light')\n    }\n  })\n}\n\nexport function setTheme(val: string) {\n  // auto模式下，则通过查询系统主题来设置主题名称\n  if (import.meta.client) {\n    document.documentElement.className = val === 'auto' ? getSystemTheme() : val\n  }\n}\n\nexport default function useTheme() {\n  const settingStore = useSettingStore()\n\n  // 开启监听系统主题变更,后期可以通过用户配置来决定是否开启\n  listenToSystemThemeChange((theme: Theme) => {\n    // 如果系统主题变更后和当前的主题一致，则不需要再重新切换\n    if (settingStore.theme === theme) {\n      return\n    }\n\n    settingStore.theme = theme\n    setTheme(theme)\n  })\n\n  function toggleTheme() {\n    // auto模式下，默认是使用系统主题，切换时应该使用当前系统主题为基础进行切换\n    settingStore.theme = swapTheme(settingStore.theme === 'auto' ? getSystemTheme() : (settingStore.theme as Theme))\n    setTheme(settingStore.theme)\n  }\n\n  // 获取当前具体的主题名称\n  function getTheme(): Theme {\n    // auto模式下，则通过查询系统主题来获取当前具体的主题名称\n    return settingStore.theme === 'auto' ? getSystemTheme() : (settingStore.theme as Theme)\n  }\n\n  return {\n    toggleTheme,\n    setTheme,\n    getTheme,\n  }\n}\n"],"version":3}