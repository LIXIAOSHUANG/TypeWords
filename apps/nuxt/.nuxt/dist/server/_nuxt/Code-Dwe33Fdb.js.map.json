{"file":"Code-Dwe33Fdb.js","mappings":"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","names":["_ref","res","_unref","_push","_parent","_ssrInterpolate","_createTextVNode","_toDisplayString"],"sources":["../../../../app/config/auth.ts","../../../../app/utils/validation.ts","../../../../app/components/user/Code.vue"],"sourcesContent":["// 微信登录配置\nexport const WECHAT_CONFIG = {\n  // 微信开放平台AppID（需要在微信开放平台申请）\n  appId: 'your_wechat_app_id',\n\n  // 微信授权回调地址\n  // redirectUri: `${window.location.origin}/wechat/callback`,\n  redirectUri: `/wechat/callback`,\n\n  // 授权作用域\n  scope: 'snsapi_userinfo',\n\n  // 授权状态参数\n  state: 'wechat_login'\n}\n\n// 获取微信授权URL\nexport function getWechatAuthUrl(state?: string): string {\n  const {appId, redirectUri, scope} = WECHAT_CONFIG\n  const authState = state || Math.random().toString(36).substr(2, 15)\n\n  return `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${appId}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=code&scope=${scope}&state=${authState}#wechat_redirect`\n}\n\n// 手机号验证配置\nexport const PHONE_CONFIG = {\n  // 验证码长度\n  codeLength: 6,\n\n  // 验证码发送间隔（秒）\n  sendInterval: 60,\n\n  // 手机号正则表达式（中国大陆）\n  phoneRegex: /^1[2-9]\\d{9}$/\n}\n\n// 邮箱配置\nexport const EMAIL_CONFIG = {\n  // 邮箱正则表达式\n  emailRegex: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/,\n\n  // 邮箱验证码长度\n  codeLength: 6\n}\n\n// 密码配置\nexport const PASSWORD_CONFIG = {\n  // 密码最小长度\n  minLength: 9,\n\n  // 密码最大长度\n  maxLength: 20\n}\n","// 邮箱验证\nimport {EMAIL_CONFIG, PASSWORD_CONFIG, PHONE_CONFIG} from \"@/config/auth.ts\";\n\nexport const validateEmail = (email: string): boolean => {\n  return EMAIL_CONFIG.emailRegex.test(email)\n}\n// 手机号验证（中国大陆）\nexport const validatePhone = (phone: string): boolean => {\n  return PHONE_CONFIG.phoneRegex.test(phone)\n}\n\nexport const codeRules = [\n  {required: true, message: '请输入验证码', trigger: 'blur'},\n  {min: PHONE_CONFIG.codeLength, message: `请输入 ${PHONE_CONFIG.codeLength} 位验证码`, trigger: 'blur'},\n]\nexport const accountRules = [\n  {required: true, message: '请输入手机号/邮箱地址', trigger: 'blur'},\n  {\n    validator: (rule: any, value: any) => {\n      if (!validatePhone(value) && !validateEmail(value)) {\n        throw new Error('请输入有效的手机号或邮箱地址')\n      }\n    }, trigger: 'blur'\n  },\n]\nexport const emailRules = [\n  {required: true, message: '请输入邮箱地址', trigger: 'blur'},\n  {\n    validator: (rule: any, value: any) => {\n      if (!validateEmail(value)) {\n        throw new Error('请输入有效的邮箱地址')\n      }\n    }, trigger: 'blur'\n  },\n]\nexport const phoneRules = [\n  {required: true, message: '请输入手机号', trigger: 'blur'},\n  {\n    validator: (rule: any, value: any) => {\n      if (!validatePhone(value)) {\n        throw new Error('请输入有效的手机号')\n      }\n    }, trigger: 'blur'\n  },\n]\nexport const passwordRules = [\n  {required: true, message: '请输入密码', trigger: 'blur'},\n  {\n    min: PASSWORD_CONFIG.minLength,\n    max: PASSWORD_CONFIG.maxLength,\n    message: `密码长度为 ${PASSWORD_CONFIG.minLength}-${PASSWORD_CONFIG.maxLength} 位`,\n    trigger: 'blur'\n  },\n]","<script setup lang=\"ts\">import { ref as _ref } from 'vue';\n\n\nimport BaseButton from \"@/components/BaseButton.vue\";\nimport {sendCode} from \"@/apis/user.ts\";\nimport {PHONE_CONFIG} from \"@/config/auth.ts\";\nimport Toast from \"@/components/base/toast/Toast.ts\";\nimport {CodeType} from \"@/types/enum.ts\";\nimport { useI18n } from 'vue-i18n';\nconst { t: $t } = useI18n();\n\nlet isSendingCode = _ref(false)\nlet codeCountdown = _ref(0)\n\ninterface IProps {\n  validateField: Function,\n  type: CodeType\n  val: any\n  size?: any\n}\n\nconst props = defineProps({\n  validateField: { type: Function },\n  type: null,\n  val: null,\n  size: { default: 'large' }\n})\n\n// 发送验证码\nasync function sendVerificationCode() {\n  let res = props.validateField()\n  if (res) {\n    try {\n      isSendingCode.value = true\n      const res = await sendCode({val: props.val, type: props.type})\n      if (res.success) {\n        codeCountdown.value = PHONE_CONFIG.sendInterval\n        const timer = setInterval(() => {\n          codeCountdown.value--\n          if (codeCountdown.value <= 0) {\n            clearInterval(timer)\n          }\n        }, 1000)\n      } else {\n        Toast.error(res.msg || $t('send_failed'))\n      }\n    } catch (error) {\n      console.error('Send code error:', error)\n      Toast.error($t('send_code_failed'))\n    } finally {\n      isSendingCode.value = false\n    }\n  }\n}\n\n</script>\n\n<template>\n  <BaseButton\n    @click=\"sendVerificationCode\"\n    :disabled=\"isSendingCode || codeCountdown > 0\"\n    type=\"info\"\n    :size=\"props.size\"\n    style=\"border: 1px solid var(--color-input-border)\"\n  >\n    {{ codeCountdown > 0 ? `${codeCountdown}s` : (isSendingCode ? $t('sending') : $t('send_code')) }}\n  </BaseButton>\n</template>\n\n<style scoped lang=\"scss\">\n\n</style>\n"],"version":3}