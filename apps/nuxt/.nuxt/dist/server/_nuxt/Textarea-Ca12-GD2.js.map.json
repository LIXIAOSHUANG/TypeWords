{"file":"Textarea-Ca12-GD2.js","mappings":"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","names":["_ssrRenderClass","_push","_ssrRenderAttr","_ssrInterpolate"],"sources":["../../../../app/components/base/select/Select.vue","../../../../app/components/base/select/Option.vue","../../../../app/components/base/Textarea.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { computed, nextTick, onBeforeUnmount, onMounted, provide, ref, useSlots, watch } from 'vue'\nimport type {VNode } from 'vue'\nimport { useWindowClick } from '@/hooks/event.ts'\n\ninterface Option {\n  label: string\n  value: any\n  disabled?: boolean\n}\n\nconst props = defineProps({\n  modelValue: null,\n  placeholder: null,\n  disabled: { type: Boolean },\n  options: null\n})\n\nconst emit = defineEmits(['update:modelValue', 'toggle'])\n\nconst isOpen = ref(false)\nconst isReverse = ref(false)\nconst dropdownStyle = ref({}) // Teleport 用的样式\nconst selectedOption = ref<Option | null>(null)\nconst selectRef = ref<HTMLDivElement | null>(null)\nconst dropdownRef = ref<HTMLDivElement | null>(null)\nconst slots = useSlots()\n\nconst displayValue = computed(() => {\n  return selectedOption.value ? selectedOption.value.label : props.placeholder || '请选择'\n})\n\nconst updateDropdownPosition = async () => {\n  if (!selectRef.value || !dropdownRef.value) return\n\n  // 等待 DOM 完全渲染（尤其是下拉框高度）\n  await nextTick()\n  await new Promise(requestAnimationFrame)\n\n  const rect = selectRef.value.getBoundingClientRect()\n  const dropdownHeight = dropdownRef.value.offsetHeight\n  const spaceBelow = window.innerHeight - rect.bottom\n  const spaceAbove = rect.top\n\n  isReverse.value = spaceBelow < dropdownHeight && spaceAbove > spaceBelow\n\n  dropdownStyle.value = {\n    position: 'fixed',\n    left: rect.left + 'px',\n    width: rect.width + 'px',\n    top: !isReverse.value ? rect.bottom + 5 + 'px' : 'auto',\n    bottom: isReverse.value ? window.innerHeight - rect.top + 5 + 'px' : 'auto',\n    zIndex: 9999,\n  }\n}\n\nconst toggleDropdown = async () => {\n  if (props.disabled) return\n\n  isOpen.value = !isOpen.value\n  emit('toggle', isOpen.value)\n\n  if (isOpen.value) {\n    await nextTick()\n    await new Promise(requestAnimationFrame)\n    await updateDropdownPosition()\n  }\n}\n\nconst selectOption = (value: any, label: string) => {\n  selectedOption.value = { value, label }\n  emit('update:modelValue', value)\n  isOpen.value = false\n  emit('toggle', isOpen.value)\n}\n\nlet selectValue = ref(props.modelValue)\n\nprovide('selectValue', selectValue)\nprovide('selectHandler', selectOption)\n\nuseWindowClick((e: PointerEvent) => {\n  if (!e) return\n  if (\n    selectRef.value &&\n    !selectRef.value.contains(e.target as Node) &&\n    dropdownRef.value &&\n    !dropdownRef.value.contains(e.target as Node)\n  ) {\n    isOpen.value = false\n    emit('toggle', isOpen.value)\n  }\n})\n\nwatch(\n  () => props.modelValue,\n  newValue => {\n    selectValue.value = newValue\n    if (slots.default) {\n      let slot = slots.default()\n      let list = []\n      if (slot.length === 1) {\n        list = Array.from(slot[0].children as Array<VNode>)\n      } else {\n        list = slot\n      }\n      const option = list.find(opt => opt.props.value === newValue)\n      if (option) {\n        selectedOption.value = option.props\n      }\n      return\n    }\n    if (props.options) {\n      const option = props.options.find(opt => opt.value === newValue)\n      if (option) {\n        selectedOption.value = option\n      }\n    }\n  },\n  { immediate: true }\n)\n\nwatch(\n  () => props.options,\n  newOptions => {\n    if (newOptions && props.modelValue) {\n      const option = newOptions.find(opt => opt.value === props.modelValue)\n      if (option) {\n        selectedOption.value = option\n      }\n    }\n  },\n  { immediate: true }\n)\n\nconst onScrollOrResize = () => {\n  if (isOpen.value) updateDropdownPosition()\n}\n\nonMounted(() => {\n  window.addEventListener('scroll', onScrollOrResize, true)\n  window.addEventListener('resize', onScrollOrResize)\n})\n\nonBeforeUnmount(() => {\n  window.removeEventListener('scroll', onScrollOrResize, true)\n  window.removeEventListener('resize', onScrollOrResize)\n})\n</script>\n\n<template>\n  <div class=\"select\" ref=\"selectRef\">\n    <div class=\"select__wrapper\" :class=\"{ disabled: disabled, active: isOpen }\" @click=\"toggleDropdown\">\n      <div class=\"select__label\" :class=\"{ 'is-placeholder': !selectedOption }\">\n        {{ displayValue }}\n      </div>\n      <IconFluentChevronLeft20Filled class=\"select__arrow\" :class=\"{ 'is-reverse': isOpen }\" width=\"16\" />\n    </div>\n\n    <teleport to=\"body\">\n      <transition :name=\"isReverse ? 'zoom-in-bottom' : 'zoom-in-top'\" :key=\"isReverse ? 'bottom' : 'top'\">\n        <div class=\"select__dropdown\" v-if=\"isOpen\" ref=\"dropdownRef\" :style=\"dropdownStyle\">\n          <slot></slot>\n        </div>\n      </transition>\n    </teleport>\n  </div>\n</template>\n\n<style scoped lang=\"scss\">\n.select {\n  @apply relative w-full;\n\n  &__wrapper {\n    @apply flex items-center justify-between rounded-md cursor-pointer transition-all duration-300;\n    height: 2rem;\n    padding: 0 0.5rem;\n    border: 1px solid var(--color-input-border);\n\n    &:not(.disabled):hover {\n      border-color: #3c89e8;\n    }\n\n    &.active {\n      border-color: #1668dc !important;\n      box-shadow: 0 0 2px 1px #166ce4;\n    }\n\n    &.disabled {\n      background: var(--color-fourth);\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n  }\n\n  &__label {\n    flex: 1;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n\n    &.is-placeholder {\n      color: #999;\n    }\n  }\n\n  &__arrow {\n    color: #999;\n    transform: rotate(-90deg);\n    transition: transform 0.3s;\n\n    &.is-reverse {\n      transform: rotate(90deg);\n    }\n  }\n}\n\n.select__dropdown {\n  max-height: 200px;\n  overflow-y: auto;\n  background-color: var(--color-card-bg);\n  @apply shadow-xl rounded-lg border border-gray-300 border-solid;\n}\n\n/* 往下展开的动画 */\n.zoom-in-top-enter-active,\n.zoom-in-top-leave-active {\n  transition:\n    transform 0.3s cubic-bezier(0.23, 1, 0.32, 1),\n    opacity 0.3s cubic-bezier(0.23, 1, 0.32, 1);\n  transform-origin: center top;\n}\n\n.zoom-in-top-enter-from,\n.zoom-in-top-leave-to {\n  opacity: 0;\n  transform: scaleY(0);\n}\n\n/* 往上展开的动画 */\n.zoom-in-bottom-enter-active,\n.zoom-in-bottom-leave-active {\n  transition:\n    transform 0.3s cubic-bezier(0.23, 1, 0.32, 1),\n    opacity 0.3s cubic-bezier(0.23, 1, 0.32, 1);\n  transform-origin: center bottom;\n}\n\n.zoom-in-bottom-enter-from,\n.zoom-in-bottom-leave-to {\n  opacity: 0;\n  transform: scaleY(0);\n}\n</style>\n","<script setup lang=\"ts\">\nimport { inject, computed, watch } from 'vue';\n\nconst props = defineProps({\n  label: null,\n  value: null,\n  disabled: { type: Boolean }\n});\n\n// 通过inject获取ElSelect提供的数据和方法\nconst selectValue = inject('selectValue', null);\nconst selectHandler = inject('selectHandler', null);\n\n// 计算当前选项是否被选中\nconst isSelected = computed(() => {\n  return selectValue.value === props.value;\n});\n\n// 点击选项时调用ElSelect提供的方法\nconst handleClick = () => {\n  if (props.disabled) return;\n  if (selectHandler) {\n    selectHandler(props.value, props.label);\n  }\n};\n\n// 监听props变化，确保在props更新时重新计算isSelected\nwatch(() => props.value, () => {}, { immediate: true });\n</script>\n\n<template>\n  <li\n    class=\"option\"\n    :class=\"{\n      'is-selected': isSelected,\n      'is-disabled': disabled\n    }\"\n    @click=\"handleClick\"\n  >\n    <slot>\n      <span class=\"option__label\">{{ label }}</span>\n    </slot>\n  </li>\n</template>\n\n<style scoped lang=\"scss\">\n.option {\n  @apply flex items-center px-2 py-1 cursor-pointer transition-all duration-300;\n\n  &:hover {\n    background-color: var(--color-fourth);\n  }\n\n  &.is-selected {\n    color: var(--color-select-bg);\n    font-weight: bold;\n    background-color: var(--color-fifth);\n  }\n\n  &.is-disabled {\n    color: #c0c4cc;\n    cursor: not-allowed;\n  }\n\n  &__label {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n}\n</style>\n","<template>\n  <div class=\"inline-flex w-full relative\" :class=\"[disabled && 'disabled']\">\n    <textarea\n      ref=\"textareaRef\"\n      v-model=\"innerValue\"\n      :placeholder=\"placeholder\"\n      :maxlength=\"maxlength\"\n      :rows=\"rows\"\n      :disabled=\"disabled\"\n      :style=\"textareaStyle\"\n      class=\"w-full px-3 py-2 border border-gray-300 rounded-md outline-none resize-none transition-colors duration-200 box-border\"\n      @input=\"handleInput\"\n    />\n    <!-- 字数统计 -->\n    <span\n      v-if=\"showWordLimit && maxlength\"\n      class=\"absolute bottom-1 right-2 text-xs text-gray-400 select-none\"\n    >\n      {{ innerValue.length }} / {{ maxlength }}\n    </span>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, computed, nextTick } from 'vue'\n\nconst props = defineProps({\n  modelValue: null,\n  placeholder: null,\n  maxlength: null,\n  rows: null,\n  autosize: { type: Boolean },\n  showWordLimit: { type: Boolean },\n  disabled: { type: Boolean }\n})\n\nconst emit = defineEmits(['update:modelValue'])\n\nconst innerValue = ref(props.modelValue ?? '')\nwatch(\n  () => props.modelValue,\n  v => (innerValue.value = v ?? '')\n)\n\nconst textareaRef = ref<HTMLTextAreaElement>()\n\n// 样式（用于控制高度）\nconst textareaStyle = computed(() => {\n  return props.autosize ? { height: 'auto' } : {}\n})\n\n// 输入处理\nconst handleInput = (e: Event) => {\n  const val = (e.target as HTMLTextAreaElement).value\n  innerValue.value = val\n  emit('update:modelValue', val)\n  if (props.autosize) nextTick(resizeTextarea)\n}\n\n// 自动调整高度\nconst resizeTextarea = () => {\n  if (!textareaRef.value) return\n  const el = textareaRef.value\n  el.style.height = 'auto'\n  let height = el.scrollHeight\n  let overflow = 'hidden'\n\n  if (typeof props.autosize === 'object') {\n    const { minRows, maxRows } = props.autosize\n    const lineHeight = 24 // 行高约等于 24px\n    if (minRows) height = Math.max(height, minRows * lineHeight)\n    if (maxRows) {\n      const maxHeight = maxRows * lineHeight\n      if (height > maxHeight) {\n        height = maxHeight\n        overflow = 'auto' // 超出时允许滚动\n      }\n    }\n  }\n\n  el.style.height = height + 'px'\n  el.style.overflowY = overflow\n}\n\nwatch(\n  innerValue,\n  () => {\n    if (props.autosize) nextTick(resizeTextarea)\n  },\n  { immediate: true }\n)\n</script>\n<style scoped lang=\"scss\">\n.disabled {\n  opacity: 0.5;\n  textarea {\n    cursor: not-allowed !important;\n  }\n}\n\ntextarea {\n  font-family: var(--font-family);\n  color: var(--color-input-color);\n  background: var(--color-input-bg);\n  @apply text-base;\n\n  &:focus {\n    outline: none;\n    border: 1px solid var(--color-select-bg);\n  }\n}\n</style>\n"],"version":3}