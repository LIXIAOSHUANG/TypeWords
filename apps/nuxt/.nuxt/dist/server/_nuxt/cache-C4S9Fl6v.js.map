{"version":3,"file":"cache-C4S9Fl6v.js","sources":["../../../../app/utils/cache.ts"],"sourcesContent":["import type { PracticeData, TaskWords } from '@/types/types.ts'\nimport type { PracticeState } from '@/stores/practice.ts'\nimport { IS_DEV } from '@/config/env'\n\nexport const PRACTICE_WORD_CACHE = {\n  key: 'PracticeSaveWord',\n  version: 1,\n}\nexport const PRACTICE_ARTICLE_CACHE = {\n  key: 'PracticeSaveArticle',\n  version: 1,\n}\n\nexport type PracticeWordCache = {\n  taskWords: TaskWords\n  practiceData: PracticeData\n  statStoreData: PracticeState\n}\n\nexport type PracticeArticleCache = {\n  practiceData: {\n    sectionIndex: number\n    sentenceIndex: number\n    wordIndex: number\n  }\n  statStoreData: PracticeState\n}\n\nexport function getPracticeWordCache(): PracticeWordCache | null {\n  let d = localStorage.getItem(PRACTICE_WORD_CACHE.key)\n  if (d) {\n    try {\n      //todo 记得删除\n      if (IS_DEV) {\n        // throw new Error('开发环境，抛出错误跳过缓存')\n      }\n      let obj = JSON.parse(d)\n      if (obj.version !== PRACTICE_WORD_CACHE.version) {\n        throw new Error()\n      }\n      return obj.val\n    } catch (e) {\n      localStorage.removeItem(PRACTICE_WORD_CACHE.key)\n    }\n  }\n  return null\n}\n\nexport function getPracticeArticleCache(): PracticeArticleCache | null {\n  let d = localStorage.getItem(PRACTICE_ARTICLE_CACHE.key)\n  if (d) {\n    try {\n      let obj = JSON.parse(d)\n      if (obj.version !== PRACTICE_ARTICLE_CACHE.version) {\n        throw new Error()\n      }\n      return obj.val\n    } catch (e) {\n      localStorage.removeItem(PRACTICE_ARTICLE_CACHE.key)\n    }\n  }\n  return null\n}\n\nexport function setPracticeWordCache(cache: PracticeWordCache | null) {\n  if (cache) {\n    localStorage.setItem(\n      PRACTICE_WORD_CACHE.key,\n      JSON.stringify({\n        version: PRACTICE_WORD_CACHE.version,\n        val: cache,\n      })\n    )\n  } else {\n    localStorage.removeItem(PRACTICE_WORD_CACHE.key)\n  }\n}\n\nexport function setPracticeArticleCache(cache: PracticeArticleCache | null) {\n  if (cache) {\n    localStorage.setItem(\n      PRACTICE_ARTICLE_CACHE.key,\n      JSON.stringify({\n        version: PRACTICE_ARTICLE_CACHE.version,\n        val: cache,\n      })\n    )\n  } else {\n    localStorage.removeItem(PRACTICE_ARTICLE_CACHE.key)\n  }\n}\n"],"names":[],"mappings":";AAIO,MAAM,sBAAsB;AAAA,EACjC,KAAK;AAAA,EACL,SAAS;AACX;AACO,MAAM,yBAAyB;AAAA,EACpC,KAAK;AAAA,EACL,SAAS;AACX;AAiBO,SAAS,uBAAiD;AAC/D,MAAI,IAAI,aAAa,QAAQ,oBAAoB,GAAG;AACpD,MAAI,GAAG;AACL,QAAI;AAEF,UAAI,OAAQ;AAGZ,UAAI,MAAM,KAAK,MAAM,CAAC;AACtB,UAAI,IAAI,YAAY,oBAAoB,SAAS;AAC/C,cAAM,IAAI,MAAA;AAAA,MACZ;AACA,aAAO,IAAI;AAAA,IACb,SAAS,GAAG;AACV,mBAAa,WAAW,oBAAoB,GAAG;AAAA,IACjD;AAAA,EACF;AACA,SAAO;AACT;AAEO,SAAS,0BAAuD;AACrE,MAAI,IAAI,aAAa,QAAQ,uBAAuB,GAAG;AACvD,MAAI,GAAG;AACL,QAAI;AACF,UAAI,MAAM,KAAK,MAAM,CAAC;AACtB,UAAI,IAAI,YAAY,uBAAuB,SAAS;AAClD,cAAM,IAAI,MAAA;AAAA,MACZ;AACA,aAAO,IAAI;AAAA,IACb,SAAS,GAAG;AACV,mBAAa,WAAW,uBAAuB,GAAG;AAAA,IACpD;AAAA,EACF;AACA,SAAO;AACT;AAEO,SAAS,qBAAqB,OAAiC;AACpE,MAAI,OAAO;AACT,iBAAa;AAAA,MACX,oBAAoB;AAAA,MACpB,KAAK,UAAU;AAAA,QACb,SAAS,oBAAoB;AAAA,QAC7B,KAAK;AAAA,MAAA,CACN;AAAA,IAAA;AAAA,EAEL,OAAO;AACL,iBAAa,WAAW,oBAAoB,GAAG;AAAA,EACjD;AACF;AAEO,SAAS,wBAAwB,OAAoC;AAC1E,MAAI,OAAO;AACT,iBAAa;AAAA,MACX,uBAAuB;AAAA,MACvB,KAAK,UAAU;AAAA,QACb,SAAS,uBAAuB;AAAA,QAChC,KAAK;AAAA,MAAA,CACN;AAAA,IAAA;AAAA,EAEL,OAAO;AACL,iBAAa,WAAW,uBAAuB,GAAG;AAAA,EACpD;AACF;"}