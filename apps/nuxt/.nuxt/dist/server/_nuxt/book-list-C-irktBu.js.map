{"version":3,"file":"book-list-C-irktBu.js","sources":["../../../../app/pages/(articles)/book-list.vue"],"sourcesContent":["<script setup lang=\"ts\">import { ref as _ref, computed as _computed } from 'vue';\n\nimport { resourceWrap, useNav } from '@/utils'\nimport BasePage from '@/components/BasePage.vue'\nimport type { Dict, DictResource } from '@/types/types.ts'\nimport { useRuntimeStore } from '@/stores/runtime.ts'\nimport BaseIcon from '@/components/BaseIcon.vue'\nimport Empty from '@/components/Empty.vue'\nimport BaseButton from '@/components/BaseButton.vue'\nimport DictList from '@/components/list/DictList.vue'\nimport BackIcon from '@/components/BackIcon.vue'\nimport { useRouter } from 'vue-router'\nimport { computed } from 'vue'\nimport { getDefaultDict } from '@/types/func.ts'\nimport { useFetch } from '@vueuse/core'\nimport { DICT_LIST } from '@/config/env.ts'\nimport BaseInput from '@/components/base/BaseInput.vue'\n\nconst { nav } = useNav()\nconst runtimeStore = useRuntimeStore()\nconst router = useRouter()\n\nfunction selectDict(e) {\n  console.log(e.dict)\n  getDictDetail(e.dict)\n}\n\nasync function getDictDetail(val: DictResource) {\n  runtimeStore.editDict = getDefaultDict(val)\n  nav('/book/' + val.id, { from: 'list' })\n}\n\nlet showSearchInput = _ref(false)\nlet searchKey = _ref('')\nconst { data: bookList, isFetching } = useFetch<DictResource[]>(resourceWrap(DICT_LIST.ARTICLE.ALL)).json()\n\nconst list = _computed(() => {\n  return bookList.value?.filter(item => !item.hidden)\n})\n\nconst searchList = computed<any[]>(() => {\n  if (searchKey.value) {\n    let s = searchKey.value.toLowerCase()\n    return list.value.filter(item => {\n      return (\n        item.id.toLowerCase().includes(s) ||\n        item.name.toLowerCase().includes(s) ||\n        item.category.toLowerCase().includes(s) ||\n        item.tags.join('').replace('所有', '').toLowerCase().includes(s) ||\n        item?.url?.toLowerCase?.().includes?.(s)\n      )\n    })\n  }\n  return []\n})\n</script>\n\n<template>\n  <BasePage>\n    <div class=\"card min-h-50\" v-loading=\"isFetching\">\n      <div class=\"flex items-center relative gap-2\">\n        <BackIcon class=\"z-2\" @Click=\"router.back\" />\n        <div class=\"flex flex-1 gap-4\" v-if=\"showSearchInput\">\n          <BaseInput\n            prefix-icon\n            placeholder=\"请输入书籍名称/缩写/类别\"\n            v-model=\"searchKey\"\n            class=\"flex-1\"\n            autofocus\n            clearable\n          />\n          <BaseButton @click=\"((showSearchInput = false), (searchKey = ''))\">{{ $t('cancel') }}</BaseButton>\n        </div>\n        <div class=\"py-1 flex flex-1 justify-end\" v-else>\n          <span class=\"page-title absolute w-full center\">{{ $t('book_list') }}</span>\n          <BaseIcon @click=\"showSearchInput = true\" class=\"z-1\">\n            <IconFluentSearch24Regular />\n          </BaseIcon>\n        </div>\n      </div>\n      <div class=\"mt-4\" v-if=\"searchKey\">\n        <DictList\n          v-if=\"searchList.length\"\n          @selectDict=\"selectDict\"\n          :list=\"searchList\"\n          quantifier=\"篇\"\n          :select-id=\"'-1'\"\n        />\n        <Empty v-else text=\"没有相关书籍\" />\n      </div>\n      <div class=\"w-full mt-2\" v-else>\n        <DictList v-if=\"list?.length\" @selectDict=\"selectDict\" :list=\"list\" quantifier=\"篇\" :select-id=\"'-1'\" />\n      </div>\n    </div>\n  </BasePage>\n</template>\n\n<style scoped lang=\"scss\"></style>\n"],"names":["_ref","_computed","_push","_parent","_ssrGetDirectiveProps","_unref","_isRef","_","_scopeId","$t","_createVNode","_ssrRenderComponent","_createBlock"],"mappings":"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"}