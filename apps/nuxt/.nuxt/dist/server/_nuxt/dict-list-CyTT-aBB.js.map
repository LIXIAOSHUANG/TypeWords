{"version":3,"file":"dict-list-CyTT-aBB.js","sources":["../../../../app/components/list/DictGroup.vue","../../../../app/pages/(words)/dict-list.vue"],"sourcesContent":["<script setup lang=\"ts\">import { computed as _computed, ref as _ref } from 'vue';\n\nimport {watch} from \"vue\";\nimport type {DictResource} from \"@/types/types.ts\";\nimport DictList from \"@/components/list/DictList.vue\";\n\nconst props = defineProps({\n  category: null,\n  groupByTag: null,\n  selectId: null\n})\nconst emit = defineEmits([\"selectDict\", \"detail\"])\nconst tagList = _computed(() => Object.keys(props.groupByTag))\nlet currentTag = _ref(tagList.value[0])\nlet list = _computed(() => {\n  return props.groupByTag[currentTag.value]\n})\n\nwatch(() => props.groupByTag, () => {\n  currentTag.value = tagList.value[0]\n})\n\n</script>\n\n<template>\n  <div>\n    <div class=\"flex items-center\">\n      <div class=\"category shrink-0\">{{ category }}：</div>\n      <div class=\"tags\">\n        <div class=\"tag\" :class=\"i === currentTag &&'active'\"\n             @click=\"currentTag = i\"\n             v-for=\"i in Object.keys(groupByTag)\">{{ i }}\n        </div>\n      </div>\n    </div>\n\n    <DictList\n        @selectDict=\"e => emit('selectDict',e)\"\n        :list=\"list\"\n        :select-id=\"selectId\"/>\n  </div>\n</template>\n\n<style scoped lang=\"scss\">\n\n.tags {\n  display: flex;\n  flex-wrap: wrap;\n  margin: 1rem 0;\n\n  .tag {\n    color: var(--color-font-1);\n    cursor: pointer;\n    padding: 0.4rem 1rem;\n    border-radius: 2rem;\n\n    &.active {\n      color: var(--color-font-active-1);\n      background: gray;\n    }\n  }\n}\n\n// 移动端适配\n@media (max-width: 768px) {\n  .flex.items-center {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 0.5rem;\n\n    .category {\n      font-size: 1rem;\n      font-weight: bold;\n    }\n\n    .tags {\n      margin: 0.5rem 0;\n      gap: 0.3rem;\n\n      .tag {\n        padding: 0.3rem 0.8rem;\n        font-size: 0.9rem;\n        min-height: 44px;\n        min-width: 44px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n    }\n  }\n}\n\n// 超小屏幕适配\n@media (max-width: 480px) {\n  .flex.items-center {\n    .category {\n      font-size: 0.9rem;\n    }\n\n    .tags {\n      .tag {\n        padding: 0.2rem 0.6rem;\n        font-size: 0.8rem;\n      }\n    }\n  }\n}\n\n</style>\n","<script setup lang=\"ts\">import { computed as _computed, ref as _ref } from 'vue';\n\nimport { _nextTick, groupBy, isMobile, loadJsLib, resourceWrap, useNav } from \"@/utils\";\nimport BasePage from \"@/components/BasePage.vue\";\nimport type { DictResource } from \"@/types/types.ts\";\nimport { useRuntimeStore } from \"@/stores/runtime.ts\";\nimport BaseIcon from \"@/components/BaseIcon.vue\";\nimport Empty from \"@/components/Empty.vue\";\nimport BaseButton from \"@/components/BaseButton.vue\";\nimport DictList from \"@/components/list/DictList.vue\";\nimport BackIcon from \"@/components/BackIcon.vue\";\nimport DictGroup from \"@/components/list/DictGroup.vue\";\nimport { useBaseStore } from \"@/stores/base.ts\";\nimport { useRouter } from \"vue-router\";\nimport { computed, watch } from \"vue\";\nimport { getDefaultDict } from \"@/types/func.ts\";\nimport { useFetch } from \"@vueuse/core\";\nimport { DICT_LIST, LIB_JS_URL, TourConfig } from \"@/config/env.ts\";\nimport BaseInput from \"@/components/base/BaseInput.vue\";\nimport { useSettingStore } from \"@/stores/setting.ts\";\n\nconst {nav} = useNav()\nconst runtimeStore = useRuntimeStore()\nconst settingStore = useSettingStore()\nconst store = useBaseStore()\nconst router = useRouter()\n\nfunction selectDict(e) {\n  console.log(e.dict)\n  getDictDetail(e.dict)\n}\n\nasync function getDictDetail(val: DictResource) {\n  runtimeStore.editDict = getDefaultDict(val)\n  nav('/dict', {from: 'list'})\n}\n\n\nfunction groupByDictTags(dictList: DictResource[]) {\n  return dictList.reduce<Record<string, DictResource[]>>((result, dict) => {\n    dict.tags.forEach((tag) => {\n      if (result[tag]) {\n        result[tag].push(dict)\n      } else {\n        result[tag] = [dict]\n      }\n    })\n    return result\n  }, {})\n}\n\nconst {data: dict_list, isFetching} = useFetch(resourceWrap(DICT_LIST.WORD.ALL)).json()\n\nconst groupedByCategoryAndTag = _computed(() => {\n  let data = []\n  if (!dict_list.value) return data\n  const groupByCategory = groupBy(dict_list.value, 'category')\n  for (const [key, value] of Object.entries(groupByCategory)) {\n    data.push([key, groupByDictTags(value)])\n  }\n  [data[2], data[3]] = [data[3], data[2]];\n  // console.log('data', data)\n  return data\n})\n\nlet showSearchInput = _ref(false)\nlet searchKey = _ref('')\n\nconst searchList = computed<any[]>(() => {\n  if (searchKey.value) {\n    let s = searchKey.value.toLowerCase()\n    return dict_list.value.filter((item) => {\n      return item.id.toLowerCase().includes(s)\n        || item.name.toLowerCase().includes(s)\n        || item.category.toLowerCase().includes(s)\n        || item.tags.join('').replace('所有', '').toLowerCase().includes(s)\n        || item?.url?.toLowerCase?.().includes?.(s)\n    })\n  }\n  return []\n})\n\nwatch(dict_list, (val) => {\n  if (!val.length) return\n  let cet4 = val.find(v => v.id === 'cet4')\n  if (!cet4) return\n  _nextTick(async () => {\n    const Shepherd = await loadJsLib('Shepherd', LIB_JS_URL.SHEPHERD);\n    const tour = new Shepherd.Tour(TourConfig);\n    tour.on('cancel', () => {\n      localStorage.setItem('tour-guide', '1');\n    });\n    tour.addStep({\n      id: 'step2',\n      text: '选一本自己准备学习的词典',\n      attachTo: {element: '#cet4', on: 'bottom'},\n      buttons: [\n        {\n          text: `下一步（2/${TourConfig.total}）`,\n          action() {\n            tour.next()\n            selectDict({dict: cet4})\n          }\n        }\n      ]\n    });\n\n    const r = localStorage.getItem('tour-guide');\n    if (settingStore.first && !r && !isMobile()) {\n      tour.start();\n    }\n  }, 500)\n})\n\n</script>\n\n<template>\n  <BasePage>\n    <div class=\"card min-h-200 dict-list-page\" v-loading=\"isFetching\">\n      <div class=\"flex items-center relative gap-2 header-section\">\n        <BackIcon class=\"z-2\" @click='router.back'/>\n        <div class=\"flex flex-1 gap-4\" v-if=\"showSearchInput\">\n          <BaseInput clearable placeholder=\"请输入词典名称/缩写/类别\" v-model=\"searchKey\" class=\"flex-1\" autofocus/>\n          <BaseButton @click=\"showSearchInput = false, searchKey = ''\">{{ $t('cancel') }}</BaseButton>\n        </div>\n        <div class=\"py-1 flex flex-1 justify-end\" v-else>\n          <span class=\"page-title absolute w-full center\">{{ $t('dict_list') }}</span>\n          <BaseIcon\n            :title=\"$t('search')\"\n            @click=\"showSearchInput = true\"\n            class=\"z-1\"\n            icon=\"fluent:search-24-regular\">\n            <IconFluentSearch24Regular/>\n          </BaseIcon>\n        </div>\n      </div>\n      <div class=\"mt-4\" v-if=\"searchKey\">\n        <DictList\n          v-if=\"searchList.length \"\n          @selectDict=\"selectDict\"\n          :list=\"searchList\"\n          quantifier=\"词\"\n          :select-id=\"'-1'\"/>\n        <Empty v-else text=\"没有相关词典\"/>\n      </div>\n      <div class=\"w-full\" v-else>\n        <DictGroup\n          v-for=\"item in groupedByCategoryAndTag\"\n          :select-id=\"store.sdict.id\"\n          @selectDict=\"selectDict\"\n          quantifier=\"词\"\n          :groupByTag=\"item[1]\"\n          :category=\"item[0]\"\n        />\n      </div>\n    </div>\n  </BasePage>\n</template>\n\n<style scoped lang=\"scss\">\n// 移动端适配\n@media (max-width: 768px) {\n  .dict-list-page {\n    padding: 0.8rem;\n    margin-bottom: 1rem;\n\n    .header-section {\n      flex-direction: column;\n      gap: 0.5rem;\n\n      .flex.flex-1.gap-4 {\n        width: 100%;\n\n        .base-input {\n          font-size: 0.9rem;\n        }\n\n        .base-button {\n          padding: 0.5rem 0.8rem;\n          font-size: 0.9rem;\n        }\n      }\n\n      .py-1.flex.flex-1.justify-end {\n        width: 100%;\n\n        .page-title {\n          font-size: 1.2rem;\n        }\n\n        .base-icon {\n          font-size: 1.2rem;\n        }\n      }\n    }\n\n    .mt-4 {\n      margin-top: 0.8rem;\n    }\n  }\n}\n\n// 超小屏幕适配\n@media (max-width: 480px) {\n  .dict-list-page {\n    padding: 0.5rem;\n\n    .header-section {\n      .flex.flex-1.gap-4 {\n        .base-input {\n          font-size: 0.8rem;\n        }\n\n        .base-button {\n          padding: 0.4rem 0.6rem;\n          font-size: 0.8rem;\n        }\n      }\n\n      .py-1.flex.flex-1.justify-end {\n        .page-title {\n          font-size: 1rem;\n        }\n\n        .base-icon {\n          font-size: 1rem;\n        }\n      }\n    }\n  }\n}\n</style>\n"],"names":["_computed","_ref","_ssrRenderList","_ssrRenderClass","_unref","dictList","_push","_parent","_ssrGetDirectiveProps","_isRef","_","_scopeId","$t","_createVNode","_ssrRenderComponent","_createBlock","_Fragment","_renderList"],"mappings":"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"}